import e,{constant as n,each as r,map as t,isUndefined as o,clone as i,has as a,isFunction as s,keys as u,filter as d,isEmpty as c,union as h,values as f,reduce as g,transform as v,size as l,isArray as p}from"lodash";import m from"graphlib";class E{constructor(e={}){this._nodes={},this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={},this._nodeCount=0,this._edgeCount=0,this._isDirected=!a(e,"directed")||e.directed,this._isMultigraph=!!a(e,"multigraph")&&e.multigraph,this._isCompound=!!a(e,"compound")&&e.compound,this._isCompound&&(this._parent={},this._children={},this._children["\0"]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return s(e)||(e=n(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return u(this._nodes)}sources(){var e=this;return d(this.nodes(),(function(n){return c(e._in[n])}))}sinks(){var e=this;return d(this.nodes(),(function(n){return c(e._out[n])}))}setNodes(e,n){var t=arguments,o=this;return r(e,(function(e){t.length>1?o.setNode(e,n):o.setNode(e)})),this}setNode(e,n){return a(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=n),this):(this._nodes[e]=arguments.length>1?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return a(this._nodes,e)}removeNode(e){var n=this;if(a(this._nodes,e)){var t=function(e){n.removeEdge(n._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r(this.children(e),(function(e){n.setParent(e)})),delete this._children[e]),r(u(this._in[e]),t),delete this._in[e],delete this._preds[e],r(u(this._out[e]),t),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(o(n))n="\0";else{for(var r=n+="";!o(r);r=this.parent(r))if(r===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var n=this._parent[e];if("\0"!==n)return n}}children(e){if(o(e)&&(e="\0"),this._isCompound){var n=this._children[e];if(n)return u(n)}else{if("\0"===e)return this.nodes();if(this.hasNode(e))return[]}return[]}predecessors(e){var n=this._preds[e];return n?u(n):[]}successors(e){var n=this._sucs[e];return n?u(n):[]}neighbors(e){var n=this.predecessors(e);if(n)return h(n,this.successors(e))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var n=new E({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var t=this;r(this._nodes,(function(r,t){e(t)&&n.setNode(t,r)})),r(this._edgeObjs,(function(e){n.hasNode(e.v)&&n.hasNode(e.w)&&n.setEdge(e,t.edge(e))}));var o={};function i(e){var r=t.parent(e);return void 0===r||n.hasNode(r)?(o[e]=r,r):r in o?o[r]:i(r)}return this._isCompound&&r(n.nodes(),(function(e){n.setParent(e,i(e))})),n}setDefaultEdgeLabel(e){return s(e)||(e=n(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return f(this._edgeObjs)}setPath(e,n){var r=this,t=arguments;return g(e,(function(e,o){return t.length>1?r.setEdge(e,o,n):r.setEdge(e,o),o})),this}setEdge(e,n,r,t){var i,s,u,d,c=!1,h=arguments[0];"object"==typeof h&&null!==h&&"v"in h?(i=h.v,s=h.w,u=h.name,2===arguments.length&&(d=arguments[1],c=!0)):(i=h,s=arguments[1],u=arguments[3],arguments.length>2&&(d=arguments[2],c=!0)),i=""+i,s=""+s,o(u)||(u=""+u);var f=b(this._isDirected,i,s,u);if(a(this._edgeLabels,f))return c&&(this._edgeLabels[f]=d),this;if(!o(u)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(i),this.setNode(s),this._edgeLabels[f]=c?d:this._defaultEdgeLabelFn(i,s,u);var g=function(e,n,r,t){var o=""+n,i=""+r;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};return t&&(s.name=t),s}(this._isDirected,i,s,u);return i=g.v,s=g.w,Object.freeze(g),this._edgeObjs[f]=g,w(this._preds[s],i),w(this._sucs[i],s),this._in[s][f]=g,this._out[i][f]=g,this._edgeCount++,this}edge(e,n,r){var t=1===arguments.length?y(this._isDirected,arguments[0]):b(this._isDirected,e,n,r);return this._edgeLabels[t]}hasEdge(e,n,r){var t=1===arguments.length?y(this._isDirected,arguments[0]):b(this._isDirected,e,n,r);return a(this._edgeLabels,t)}removeEdge(e,n,r){var t=1===arguments.length?y(this._isDirected,arguments[0]):b(this._isDirected,e,n,r),o=this._edgeObjs[t];if(o){const e=o.v,n=o.w;delete this._edgeLabels[t],delete this._edgeObjs[t],_(this._preds[n],e),_(this._sucs[e],n),delete this._in[n][t],delete this._out[e][t],this._edgeCount--}return this}inEdges(e,n){var r=this._in[e];if(r){var t=f(r);return n?d(t,(function(e){return e.v===n})):t}}outEdges(e,n){var r=this._out[e];if(r){var t=f(r);return n?d(t,(function(e){return e.w===n})):t}}nodeEdges(e,n){var r=this.inEdges(e,n);if(r)return r.concat(this.outEdges(e,n))}}function w(e,n){e[n]?e[n]++:e[n]=1}function _(e,n){--e[n]||delete e[n]}function b(e,n,r,t){var i=""+n,a=""+r;if(!e&&i>a){var s=i;i=a,a=s}return i+""+a+""+(o(t)?"\0":t)}function y(e,n){return b(e,n.v,n.w,n.name)}var k={Graph:E};class N{constructor(){this._arr=[],this._keyIndices={}}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return a(this._keyIndices,e)}priority(e){var n=this._keyIndices[e];if(void 0!==n)return this._arr[n].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,n){var r=this._keyIndices;if(e=String(e),!a(r,e)){var t=this._arr,o=t.length;return r[e]=o,t.push({key:e,priority:n}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,n){var r=this._keyIndices[e];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(e){var n=this._arr,r=2*e,t=r+1,o=e;r<n.length&&(o=n[r].priority<n[o].priority?r:o,t<n.length&&(o=n[t].priority<n[o].priority?t:o),o!==e&&(this._swap(e,o),this._heapify(o)))}_decrease(e){for(var n,r=this._arr,t=r[e].priority;0!==e&&!(r[n=e>>1].priority<t);)this._swap(e,n),e=n}_swap(e,n){var r=this._arr,t=this._keyIndices,o=r[e],i=r[n];r[e]=i,r[n]=o,t[i.key]=e,t[o.key]=n}}var x=n(1);function I(e,n,r,t){return function(e,n,r,t){var o,i,a={},s=new N,u=function(e){var n=e.v!==o?e.v:e.w,t=a[n],u=r(e),d=i.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+u);d<t.distance&&(t.distance=d,t.predecessor=o,s.decrease(n,d))};for(e.nodes().forEach((function(e){var r=e===n?0:Number.POSITIVE_INFINITY;a[e]={distance:r},s.add(e,r)}));s.size()>0&&(o=s.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)t(o).forEach(u);return a}(e,String(n),r||x,t||function(n){return e.outEdges(n)})}function C(e){var n=0,r=[],t={},o=[];function i(s){var u=t[s]={onStack:!0,lowlink:n,index:n++};if(r.push(s),e.successors(s).forEach((function(e){a(t,e)?t[e].onStack&&(u.lowlink=Math.min(u.lowlink,t[e].index)):(i(e),u.lowlink=Math.min(u.lowlink,t[e].lowlink))})),u.lowlink===u.index){var d,c=[];do{d=r.pop(),t[d].onStack=!1,c.push(d)}while(s!==d);o.push(c)}}return e.nodes().forEach((function(e){a(t,e)||i(e)})),o}var L=n(1);function M(e){var n={},t={},o=[];if(r(e.sinks(),(function i(s){if(a(t,s))throw new R;a(n,s)||(t[s]=!0,n[s]=!0,r(e.predecessors(s),i),delete t[s],o.push(s))})),l(n)!==e.nodeCount())throw new R;return o}function R(){}function T(e,n,t){p(n)||(n=[n]);var o=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return r(n,(function(n){if(!e.hasNode(n))throw new Error("Graph does not have node: "+n);G(e,n,"post"===t,a,o,i)})),i}function G(e,n,t,o,i,s){a(o,n)||(o[n]=!0,t||s.push(n),r(i(n),(function(n){G(e,n,t,o,i,s)})),t&&s.push(n))}function P(e){return t(e.nodes(),(function(n){var r=e.node(n),t=e.parent(n),i={v:n};return o(r)||(i.value=r),o(t)||(i.parent=t),i}))}function O(e){return t(e.edges(),(function(n){var r=e.edge(n),t={v:n.v,w:n.w};return o(n.name)||(t.name=n.name),o(r)||(t.value=r),t}))}M.CycleException=R,R.prototype=new Error;var D={Graph:k.Graph,json:{read:function(e){var n=new E(e.options).setGraph(e.value);return r(e.nodes,(function(e){n.setNode(e.v,e.value),e.parent&&n.setParent(e.v,e.parent)})),r(e.edges,(function(e){n.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),n},write:function(e){var n={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:P(e),edges:O(e)};return o(e.graph())||(n.value=i(e.graph())),n}},alg:{components:function(e){var n,t={},o=[];function i(o){a(t,o)||(t[o]=!0,n.push(o),r(e.successors(o),i),r(e.predecessors(o),i))}return r(e.nodes(),(function(e){n=[],i(e),n.length&&o.push(n)})),o},dijkstra:I,dijkstraAll:function(e,n,r){return v(e.nodes(),(function(t,o){t[o]=I(e,o,n,r)}),{})},findCycles:function(e){return d(C(e),(function(n){return n.length>1||1===n.length&&e.hasEdge(n[0],n[0])}))},isAcyclic:function(e){try{M(e)}catch(e){if(e instanceof M.CycleException)return!1;throw e}return!0},floydWarshall:function(e,n,r){return function(e,n,r){var t={},o=e.nodes();return o.forEach((function(e){t[e]={},t[e][e]={distance:0},o.forEach((function(n){e!==n&&(t[e][n]={distance:Number.POSITIVE_INFINITY})})),r(e).forEach((function(r){var o=r.v===e?r.w:r.v,i=n(r);t[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var n=t[e];o.forEach((function(r){var i=t[r];o.forEach((function(r){var t=i[e],o=n[r],a=i[r],s=t.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),t}(e,n||L,r||function(n){return e.outEdges(n)})},postorder:function(e,n){return T(e,n,"post")},preorder:function(e,n){return T(e,n,"pre")},prim:function(e,n){var t,o=new E,i={},s=new N;function u(e){var r=e.v===t?e.w:e.v,o=s.priority(r);if(void 0!==o){var a=n(e);a<o&&(i[r]=t,s.decrease(r,a))}}if(0===e.nodeCount())return o;r(e.nodes(),(function(e){s.add(e,Number.POSITIVE_INFINITY),o.setNode(e)})),s.decrease(e.nodes()[0],0);for(var d=!1;s.size()>0;){if(t=s.removeMin(),a(i,t))o.setEdge(t,i[t]);else{if(d)throw new Error("Input graph is not connected: "+e);d=!0}e.nodeEdges(t).forEach(u)}return o},tarjan:C,topsort:M},version:k.version};function S(){var e={};e._next=e._prev=e,this._sentinel=e}function j(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function F(e,n){if("_next"!==e&&"_prev"!==e)return n}S.prototype.dequeue=function(){var e=this._sentinel,n=e._prev;if(n!==e)return j(n),n},S.prototype.enqueue=function(e){var n=this._sentinel;e._prev&&e._next&&j(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n},S.prototype.toString=function(){for(var e=[],n=this._sentinel,r=n._prev;r!==n;)e.push(JSON.stringify(r,F)),r=r._prev;return"["+e.join(", ")+"]"};var B=m.Graph;function V(n,r){if(n.nodeCount()<=1)return[];var t=function(n,r){var t=new B,o=0,i=0;e.forEach(n.nodes(),(function(e){t.setNode(e,{v:e,in:0,out:0})})),e.forEach(n.edges(),(function(e){var n=t.edge(e.v,e.w)||0,a=r(e),s=n+a;t.setEdge(e.v,e.w,s),i=Math.max(i,t.node(e.v).out+=a),o=Math.max(o,t.node(e.w).in+=a)}));var a=e.range(i+o+3).map((function(){return new S})),s=o+1;return e.forEach(t.nodes(),(function(e){Y(a,s,t.node(e))})),{graph:t,buckets:a,zeroIdx:s}}(n,r||1),o=function(e,n,r){var t,o=[],i=n[n.length-1],a=n[0];for(;e.nodeCount();){for(;t=a.dequeue();)z(e,n,r,t);for(;t=i.dequeue();)z(e,n,r,t);if(e.nodeCount())for(var s=n.length-2;s>0;--s)if(t=n[s].dequeue()){o=o.concat(z(e,n,r,t,!0));break}}return o}(t.graph,t.buckets,t.zeroIdx);return e.flatten(e.map(o,(function(e){return n.outEdges(e.v,e.w)})),!0)}function z(n,r,t,o,i){var a=i?[]:void 0;return e.forEach(n.inEdges(o.v),(function(e){var o=n.edge(e),s=n.node(e.v);i&&a.push({v:e.v,w:e.w}),s.out-=o,Y(r,t,s)})),e.forEach(n.outEdges(o.v),(function(e){var o=n.edge(e),i=e.w,a=n.node(i);a.in-=o,Y(r,t,a)})),n.removeNode(o.v),a}function Y(e,n,r){r.out?r.in?e[r.out-r.in+n].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var q={run:function(n){var r="greedy"===n.graph().acyclicer?V(n,function(e){return function(n){return e.edge(n).weight}}(n)):function(n){var r=[],t={},o={};function i(a){e.has(o,a)||(o[a]=!0,t[a]=!0,e.forEach(n.outEdges(a),(function(n){e.has(t,n.w)?r.push(n):i(n.w)})),delete t[a])}return e.forEach(n.nodes(),i),r}(n);e.forEach(r,(function(r){var t=n.edge(r);n.removeEdge(r),t.forwardName=r.name,t.reversed=!0,n.setEdge(r.w,r.v,t,e.uniqueId("rev"))}))},undo:function(n){e.forEach(n.edges(),(function(e){var r=n.edge(e);if(r.reversed){n.removeEdge(e);var t=r.forwardName;delete r.reversed,delete r.forwardName,n.setEdge(e.w,e.v,r,t)}}))}},U=m.Graph,A={addDummyNode:W,simplify:J,asNonCompoundGraph:function(n){var r=new U({multigraph:n.isMultigraph()}).setGraph(n.graph());return e.forEach(n.nodes(),(function(e){n.children(e).length||r.setNode(e,n.node(e))})),e.forEach(n.edges(),(function(e){r.setEdge(e,n.edge(e))})),r},successorWeights:function(n){var r=e.map(n.nodes(),(function(r){var t={};return e.forEach(n.outEdges(r),(function(e){t[e.w]=(t[e.w]||0)+n.edge(e).weight})),t}));return e.zipObject(n.nodes(),r)},predecessorWeights:function(n){var r=e.map(n.nodes(),(function(r){var t={};return e.forEach(n.inEdges(r),(function(e){t[e.v]=(t[e.v]||0)+n.edge(e).weight})),t}));return e.zipObject(n.nodes(),r)},intersectRect:function(e,n){var r,t,o=e.x,i=e.y,a=n.x-o,s=n.y-i,u=e.width/2,d=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,t=d):(a<0&&(u=-u),r=u,t=u*s/a);return{x:o+r,y:i+t}},buildLayerMatrix:function(n){var r=e.map(e.range(H(n)+1),(function(){return[]}));return e.forEach(n.nodes(),(function(t){var o=n.node(t),i=o.rank;e.isUndefined(i)||(r[i][o.order]=t)})),r},normalizeRanks:K,removeEmptyRanks:Q,addBorderNode:function(e,n,r,t){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=t);return W(e,"border",o,n)},maxRank:H,partition:function(n,r){var t={lhs:[],rhs:[]};return e.forEach(n,(function(e){r(e)?t.lhs.push(e):t.rhs.push(e)})),t},time:X,notime:Z};function W(n,r,t,o){var i;do{i=e.uniqueId(o)}while(n.hasNode(i));return t.dummy=r,n.setNode(i,t),i}function J(n){var r=(new U).setGraph(n.graph());return e.forEach(n.nodes(),(function(e){r.setNode(e,n.node(e))})),e.forEach(n.edges(),(function(e){var t=r.edge(e.v,e.w)||{weight:0,minlen:1},o=n.edge(e);r.setEdge(e.v,e.w,{weight:t.weight+o.weight,minlen:Math.max(t.minlen,o.minlen)})})),r}function K(n){var r=e.min(e.map(n.nodes(),(function(e){return n.node(e).rank})));e.forEach(n.nodes(),(function(t){var o=n.node(t);e.has(o,"rank")&&(o.rank-=r)}))}function Q(n){var r=e.min(e.map(n.nodes(),(function(e){return n.node(e).rank}))),t=[];e.forEach(n.nodes(),(function(e){var o=n.node(e).rank-r;t[o]||(t[o]=[]),t[o].push(e)}));var o=0,i=n.graph().nodeRankFactor;e.forEach(t,(function(r,t){e.isUndefined(r)&&t%i!=0?--o:o&&e.forEach(r,(function(e){n.node(e).rank+=o}))}))}function H(n){return e.max(e.map(n.nodes(),(function(r){var t=n.node(r).rank;if(!e.isUndefined(t))return t})))}function X(n,r){var t=e.now();try{return r()}finally{console.log(n+" time: "+(e.now()-t)+"ms")}}function Z(e,n){return n()}var $={run:function(n){n.graph().dummyChains=[],e.forEach(n.edges(),(function(e){!function(e,n){var r,t,o,i=n.v,a=e.node(i).rank,s=n.w,u=e.node(s).rank,d=n.name,c=e.edge(n),h=c.labelRank;if(u===a+1)return;for(e.removeEdge(n),o=0,++a;a<u;++o,++a)c.points=[],t={width:0,height:0,edgeLabel:c,edgeObj:n,rank:a},r=A.addDummyNode(e,"edge",t,"_d"),a===h&&(t.width=c.width,t.height=c.height,t.dummy="edge-label",t.labelpos=c.labelpos),e.setEdge(i,r,{weight:c.weight},d),0===o&&e.graph().dummyChains.push(r),i=r;e.setEdge(i,s,{weight:c.weight},d)}(n,e)}))},undo:function(n){e.forEach(n.graph().dummyChains,(function(e){var r,t=n.node(e),o=t.edgeLabel;for(n.setEdge(t.edgeObj,o);t.dummy;)r=n.successors(e)[0],n.removeNode(e),o.points.push({x:t.x,y:t.y}),"edge-label"===t.dummy&&(o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height),e=r,t=n.node(e)}))}};function ee(n){var r={};e.forEach(n.sources(),(function t(o){var i=n.node(o);if(e.has(r,o))return i.rank;r[o]=!0;var a=e.min(e.map(n.outEdges(o),(function(e){return t(e.w)-n.edge(e).minlen})));return a!==Number.POSITIVE_INFINITY&&null!=a||(a=0),i.rank=a}))}function ne(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen}var re=ee,te=m.Graph;function oe(e){var n,r,t=new te({directed:!1}),o=e.nodes()[0],i=e.nodeCount();for(t.setNode(o,{});ie(t,e)<i;)n=ae(t,e),r=t.hasNode(n.v)?ne(e,n):-ne(e,n),se(t,e,r);return t}function ie(n,r){return e.forEach(n.nodes(),(function t(o){e.forEach(r.nodeEdges(o),(function(e){var i=e.v,a=o===i?e.w:i;n.hasNode(a)||ne(r,e)||(n.setNode(a,{}),n.setEdge(o,a,{}),t(a))}))})),n.nodeCount()}function ae(n,r){return e.minBy(r.edges(),(function(e){if(n.hasNode(e.v)!==n.hasNode(e.w))return ne(r,e)}))}function se(n,r,t){e.forEach(n.nodes(),(function(e){r.node(e).rank+=t}))}var ue=m.alg.preorder,de=m.alg.postorder;function ce(e){ee(e=J(e));var n,r=oe(e);for(ge(r),he(r,e);n=le(r);)me(r,e,n,pe(r,e,n))}function he(n,r){var t=de(n,n.nodes());t=t.slice(0,t.length-1),e.forEach(t,(function(e){!function(e,n,r){var t=e.node(r).parent;e.edge(r,t).cutvalue=fe(e,n,r)}(n,r,e)}))}function fe(n,r,t){var o=n.node(t).parent,i=!0,a=r.edge(t,o),s=0;return a||(i=!1,a=r.edge(o,t)),s=a.weight,e.forEach(r.nodeEdges(t),(function(e){var a=e.v===t,u=a?e.w:e.v;if(u!==o){var d=a===i,c=r.edge(e).weight;if(s+=d?c:-c,function(e,n,r){return e.hasEdge(n,r)}(n,t,u)){var h=n.edge(t,u).cutvalue;s+=d?-h:h}}})),s}function ge(e,n){arguments.length<2&&(n=e.nodes()[0]),ve(e,{},1,n)}function ve(n,r,t,o,i){var a=t,s=n.node(o);return r[o]=!0,e.forEach(n.neighbors(o),(function(i){e.has(r,i)||(t=ve(n,r,t,i,o))})),s.low=a,s.lim=t++,i?s.parent=i:delete s.parent,t}function le(n){return e.find(n.edges(),(function(e){return n.edge(e).cutvalue<0}))}function pe(n,r,t){var o=t.v,i=t.w;r.hasEdge(o,i)||(o=t.w,i=t.v);var a=n.node(o),s=n.node(i),u=a,d=!1;a.lim>s.lim&&(u=s,d=!0);var c=e.filter(r.edges(),(function(e){return d===Ee(n,n.node(e.v),u)&&d!==Ee(n,n.node(e.w),u)}));return e.minBy(c,(function(e){return ne(r,e)}))}function me(n,r,t,o){var i=t.v,a=t.w;n.removeEdge(i,a),n.setEdge(o.v,o.w,{}),ge(n),he(n,r),function(n,r){var t=e.find(n.nodes(),(function(e){return!r.node(e).parent})),o=ue(n,t);o=o.slice(1),e.forEach(o,(function(e){var t=n.node(e).parent,o=r.edge(e,t),i=!1;o||(o=r.edge(t,e),i=!0),r.node(e).rank=r.node(t).rank+(i?o.minlen:-o.minlen)}))}(n,r)}function Ee(e,n,r){return r.low<=n.lim&&n.lim<=r.lim}ce.initLowLimValues=ge,ce.initCutValues=he,ce.calcCutValue=fe,ce.leaveEdge=le,ce.enterEdge=pe,ce.exchangeEdges=me;var we=re;function _e(e){switch(e.graph().ranker){case"network-simplex":default:ye(e);break;case"tight-tree":!function(e){we(e),oe(e)}(e);break;case"longest-path":be(e)}}var be=we;function ye(e){ce(e)}function ke(n){var r=function(n){var r={},t=0;function o(i){var a=t;e.forEach(n.children(i),o),r[i]={low:a,lim:t++}}return e.forEach(n.children(),o),r}(n);e.forEach(n.graph().dummyChains,(function(e){for(var t=n.node(e),o=t.edgeObj,i=function(e,n,r,t){var o,i,a=[],s=[],u=Math.min(n[r].low,n[t].low),d=Math.max(n[r].lim,n[t].lim);o=r;do{o=e.parent(o),a.push(o)}while(o&&(n[o].low>u||d>n[o].lim));i=o,o=t;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(n,r,o.v,o.w),a=i.path,s=i.lca,u=0,d=a[u],c=!0;e!==o.w;){if(t=n.node(e),c){for(;(d=a[u])!==s&&n.node(d).maxRank<t.rank;)u++;d===s&&(c=!1)}if(!c){for(;u<a.length-1&&n.node(d=a[u+1]).minRank<=t.rank;)u++;d=a[u]}n.setParent(e,d),e=n.successors(e)[0]}}))}function Ne(n,r,t,o,i,a,s){var u=n.children(s);if(u.length){var d=A.addBorderNode(n,"_bt"),c=A.addBorderNode(n,"_bb"),h=n.node(s);n.setParent(d,s),h.borderTop=d,n.setParent(c,s),h.borderBottom=c,e.forEach(u,(function(e){Ne(n,r,t,o,i,a,e);var u=n.node(e),h=u.borderTop?u.borderTop:e,f=u.borderBottom?u.borderBottom:e,g=u.borderTop?o:2*o,v=h!==f?1:i-a[s]+1;n.setEdge(d,h,{weight:g,minlen:v,nestingEdge:!0}),n.setEdge(f,c,{weight:g,minlen:v,nestingEdge:!0})})),n.parent(s)||n.setEdge(r,d,{weight:0,minlen:i+a[s]})}else s!==r&&n.setEdge(r,s,{weight:0,minlen:t})}var xe={run:function(n){var r=A.addDummyNode(n,"root",{},"_root"),t=function(n){var r={};function t(o,i){var a=n.children(o);a&&a.length&&e.forEach(a,(function(e){t(e,i+1)})),r[o]=i}return e.forEach(n.children(),(function(e){t(e,1)})),r}(n),o=e.max(e.values(t))-1,i=2*o+1;n.graph().nestingRoot=r,e.forEach(n.edges(),(function(e){n.edge(e).minlen*=i}));var a=function(n){return e.reduce(n.edges(),(function(e,r){return e+n.edge(r).weight}),0)}(n)+1;e.forEach(n.children(),(function(e){Ne(n,r,i,a,o,t,e)})),n.graph().nodeRankFactor=i},cleanup:function(n){var r=n.graph();n.removeNode(r.nestingRoot),delete r.nestingRoot,e.forEach(n.edges(),(function(e){n.edge(e).nestingEdge&&n.removeEdge(e)}))}};function Ie(e,n,r,t,o,i){var a={width:0,height:0,rank:i,borderType:n},s=o[n][i-1],u=A.addDummyNode(e,"border",a,r);o[n][i]=u,e.setParent(u,t),s&&e.setEdge(s,u,{weight:1})}function Ce(n){e.forEach(n.nodes(),(function(e){Le(n.node(e))})),e.forEach(n.edges(),(function(e){Le(n.edge(e))}))}function Le(e){var n=e.width;e.width=e.height,e.height=n}function Me(e){e.y=-e.y}function Re(e){var n=e.x;e.x=e.y,e.y=n}var Te={adjust:function(e){var n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||Ce(e)},undo:function(n){var r=n.graph().rankdir.toLowerCase();"bt"!==r&&"rl"!==r||function(n){e.forEach(n.nodes(),(function(e){Me(n.node(e))})),e.forEach(n.edges(),(function(r){var t=n.edge(r);e.forEach(t.points,Me),e.has(t,"y")&&Me(t)}))}(n),"lr"!==r&&"rl"!==r||(!function(n){e.forEach(n.nodes(),(function(e){Re(n.node(e))})),e.forEach(n.edges(),(function(r){var t=n.edge(r);e.forEach(t.points,Re),e.has(t,"x")&&Re(t)}))}(n),Ce(n))}};function Ge(e,n){for(var r=0,t=1;t<n.length;++t)r+=Pe(e,n[t-1],n[t]);return r}function Pe(n,r,t){for(var o=e.zipObject(t,e.map(t,(function(e,n){return n}))),i=e.flatten(e.map(r,(function(r){return e.sortBy(e.map(n.outEdges(r),(function(e){return{pos:o[e.w],weight:n.edge(e).weight}})),"pos")})),!0),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var u=e.map(new Array(s),(function(){return 0})),d=0;return e.forEach(i.forEach((function(e){var n=e.pos+a;u[n]+=e.weight;for(var r=0;n>0;)n%2&&(r+=u[n+1]),u[n=n-1>>1]+=e.weight;d+=e.weight*r}))),d}function Oe(n,r){var t={};return e.forEach(n,(function(n,r){var o=t[n.v]={indegree:0,in:[],out:[],vs:[n.v],i:r};e.isUndefined(n.barycenter)||(o.barycenter=n.barycenter,o.weight=n.weight)})),e.forEach(r.edges(),(function(n){var r=t[n.v],o=t[n.w];e.isUndefined(r)||e.isUndefined(o)||(o.indegree++,r.out.push(t[n.w]))})),function(n){var r=[];function t(n){return function(r){r.merged||(e.isUndefined(r.barycenter)||e.isUndefined(n.barycenter)||r.barycenter>=n.barycenter)&&function(e,n){var r=0,t=0;e.weight&&(r+=e.barycenter*e.weight,t+=e.weight);n.weight&&(r+=n.barycenter*n.weight,t+=n.weight);e.vs=n.vs.concat(e.vs),e.barycenter=r/t,e.weight=t,e.i=Math.min(n.i,e.i),n.merged=!0}(n,r)}}function o(e){return function(r){r.in.push(e),0==--r.indegree&&n.push(r)}}for(;n.length;){var i=n.pop();r.push(i),e.forEach(i.in.reverse(),t(i)),e.forEach(i.out,o(i))}return e.map(e.filter(r,(function(e){return!e.merged})),(function(n){return e.pick(n,["vs","i","barycenter","weight"])}))}(e.filter(t,(function(e){return!e.indegree})))}function De(n,r,t){for(var o;r.length&&(o=e.last(r)).i<=t;)r.pop(),n.push(o.vs),t++;return t}function Se(n,r,t,o){var i=n.children(r),a=n.node(r),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,d={};s&&(i=e.filter(i,(function(e){return e!==s&&e!==u})));var c=function(n,r){return e.map(r,(function(r){var t=n.inEdges(r);if(t.length){var o=e.reduce(t,(function(e,r){var t=n.edge(r),o=n.node(r.v);return{sum:e.sum+t.weight*o.order,weight:e.weight+t.weight}}),{sum:0,weight:0});return{v:r,barycenter:o.sum/o.weight,weight:o.weight}}return{v:r}}))}(n,i);e.forEach(c,(function(r){if(n.children(r.v).length){var i=Se(n,r.v,t,o);d[r.v]=i,e.has(i,"barycenter")&&(a=r,s=i,e.isUndefined(a.barycenter)?(a.barycenter=s.barycenter,a.weight=s.weight):(a.barycenter=(a.barycenter*a.weight+s.barycenter*s.weight)/(a.weight+s.weight),a.weight+=s.weight))}var a,s}));var h=Oe(c,t);!function(n,r){e.forEach(n,(function(n){n.vs=e.flatten(n.vs.map((function(e){return r[e]?r[e].vs:e})),!0)}))}(h,d);var f=function(n,r){var t,o=A.partition(n,(function(n){return e.has(n,"barycenter")})),i=o.lhs,a=e.sortBy(o.rhs,(function(e){return-e.i})),s=[],u=0,d=0,c=0;i.sort((t=!!r,function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i})),c=De(s,a,c),e.forEach(i,(function(e){c+=e.vs.length,s.push(e.vs),u+=e.barycenter*e.weight,d+=e.weight,c=De(s,a,c)}));var h={vs:e.flatten(s,!0)};return d&&(h.barycenter=u/d,h.weight=d),h}(h,o);if(s&&(f.vs=e.flatten([s,f.vs,u],!0),n.predecessors(s).length)){var g=n.node(n.predecessors(s)[0]),v=n.node(n.predecessors(u)[0]);e.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+g.order+v.order)/(f.weight+2),f.weight+=2}return f}var je=m.Graph;function Fe(n,r,t){var o=function(n){var r;for(;n.hasNode(r=e.uniqueId("_root")););return r}(n),i=new je({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(e){return n.node(e)}));return e.forEach(n.nodes(),(function(a){var s=n.node(a),u=n.parent(a);(s.rank===r||s.minRank<=r&&r<=s.maxRank)&&(i.setNode(a),i.setParent(a,u||o),e.forEach(n[t](a),(function(r){var t=r.v===a?r.w:r.v,o=i.edge(t,a),s=e.isUndefined(o)?0:o.weight;i.setEdge(t,a,{weight:n.edge(r).weight+s})})),e.has(s,"minRank")&&i.setNode(a,{borderLeft:s.borderLeft[r],borderRight:s.borderRight[r]}))})),i}var Be=m.Graph;function Ve(n){var r=A.maxRank(n),t=ze(n,e.range(1,r+1),"inEdges"),o=ze(n,e.range(r-1,-1,-1),"outEdges"),i=function(n){var r={},t=e.filter(n.nodes(),(function(e){return!n.children(e).length})),o=e.max(e.map(t,(function(e){return n.node(e).rank}))),i=e.map(e.range(o+1),(function(){return[]})),a=e.sortBy(t,(function(e){return n.node(e).rank}));return e.forEach(a,(function t(o){if(!e.has(r,o)){r[o]=!0;var a=n.node(o);i[a.rank].push(o),e.forEach(n.successors(o),t)}})),i}(n);qe(n,i);for(var a,s=Number.POSITIVE_INFINITY,u=0,d=0;d<4;++u,++d){Ye(u%2?t:o,u%4>=2);var c=Ge(n,i=A.buildLayerMatrix(n));c<s&&(d=0,a=e.cloneDeep(i),s=c)}qe(n,a)}function ze(n,r,t){return e.map(r,(function(e){return Fe(n,e,t)}))}function Ye(n,r){var t=new Be;e.forEach(n,(function(n){var o=n.graph().root,i=Se(n,o,t,r);e.forEach(i.vs,(function(e,r){n.node(e).order=r})),function(n,r,t){var o,i={};e.forEach(t,(function(e){for(var t,a,s=n.parent(e);s;){if((t=n.parent(s))?(a=i[t],i[t]=s):(a=o,o=s),a&&a!==s)return void r.setEdge(a,s);s=t}}))}(n,t,i.vs)}))}function qe(n,r){e.forEach(r,(function(r){e.forEach(r,(function(e,r){n.node(e).order=r}))}))}var Ue=m.Graph,Ae=function(n){var r,t=A.buildLayerMatrix(n),o=e.merge(We(n,t),Je(n,t)),i={};e.forEach(["u","d"],(function(a){r="u"===a?t:e.values(t).reverse(),e.forEach(["l","r"],(function(t){"r"===t&&(r=e.map(r,(function(n){return e.values(n).reverse()})));var s=("u"===a?n.predecessors:n.successors).bind(n),u=He(n,r,o,s),d=Xe(n,r,u.root,u.align,"r"===t);"r"===t&&(d=e.mapValues(d,(function(e){return-e}))),i[a+t]=d}))}));var a=Ze(n,i);return $e(i,a),en(i,n.graph().align)};function We(n,r){var t={};return e.reduce(r,(function(r,o){var i=0,a=0,s=r.length,u=e.last(o);return e.forEach(o,(function(r,d){var c=function(n,r){if(n.node(r).dummy)return e.find(n.predecessors(r),(function(e){return n.node(e).dummy}))}(n,r),h=c?n.node(c).order:s;(c||r===u)&&(e.forEach(o.slice(a,d+1),(function(r){e.forEach(n.predecessors(r),(function(e){var o=n.node(e),a=o.order;!(a<i||h<a)||o.dummy&&n.node(r).dummy||Ke(t,e,r)}))})),a=d+1,i=h)})),o})),t}function Je(n,r){var t={};function o(r,o,i,a,s){var u;e.forEach(e.range(o,i),(function(o){u=r[o],n.node(u).dummy&&e.forEach(n.predecessors(u),(function(e){var r=n.node(e);r.dummy&&(r.order<a||r.order>s)&&Ke(t,e,u)}))}))}return e.reduce(r,(function(r,t){var i,a=-1,s=0;return e.forEach(t,(function(e,u){if("border"===n.node(e).dummy){var d=n.predecessors(e);d.length&&(i=n.node(d[0]).order,o(t,s,u,a,i),s=u,a=i)}o(t,s,t.length,i,r.length)})),t})),t}function Ke(e,n,r){if(n>r){var t=n;n=r,r=t}var o=e[n];o||(e[n]=o={}),o[r]=!0}function Qe(n,r,t){if(r>t){var o=r;r=t,t=o}return e.has(n[r],t)}function He(n,r,t,o){var i={},a={},s={};return e.forEach(r,(function(n){e.forEach(n,(function(e,n){i[e]=e,a[e]=e,s[e]=n}))})),e.forEach(r,(function(n){var r=-1;e.forEach(n,(function(n){var u=o(n);if(u.length){u=e.sortBy(u,(function(e){return s[e]}));for(var d=(u.length-1)/2,c=Math.floor(d),h=Math.ceil(d);c<=h;++c){var f=u[c];a[n]===n&&r<s[f]&&!Qe(t,n,f)&&(a[f]=n,a[n]=i[n]=i[f],r=s[f])}}}))})),{root:i,align:a}}function Xe(n,r,t,o,i){var a={},s=function(n,r,t,o){var i=new Ue,a=n.graph(),s=function(n,r,t){return function(o,i,a){var s,u=o.node(i),d=o.node(a),c=0;if(c+=u.width/2,e.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=-u.width/2;break;case"r":s=u.width/2}if(s&&(c+=t?s:-s),s=0,c+=(u.dummy?r:n)/2,c+=(d.dummy?r:n)/2,c+=d.width/2,e.has(d,"labelpos"))switch(d.labelpos.toLowerCase()){case"l":s=d.width/2;break;case"r":s=-d.width/2}return s&&(c+=t?s:-s),s=0,c}}(a.nodesep,a.edgesep,o);return e.forEach(r,(function(r){var o;e.forEach(r,(function(e){var r=t[e];if(i.setNode(r),o){var a=t[o],u=i.edge(a,r);i.setEdge(a,r,Math.max(s(n,e,o),u||0))}o=e}))})),i}(n,r,t,i),u=i?"borderLeft":"borderRight";function d(e,n){for(var r=s.nodes(),t=r.pop(),o={};t;)o[t]?e(t):(o[t]=!0,r.push(t),r=r.concat(n(t))),t=r.pop()}return d((function(e){a[e]=s.inEdges(e).reduce((function(e,n){return Math.max(e,a[n.v]+s.edge(n))}),0)}),s.predecessors.bind(s)),d((function(e){var r=s.outEdges(e).reduce((function(e,n){return Math.min(e,a[n.w]-s.edge(n))}),Number.POSITIVE_INFINITY),t=n.node(e);r!==Number.POSITIVE_INFINITY&&t.borderType!==u&&(a[e]=Math.max(a[e],r))}),s.successors.bind(s)),e.forEach(o,(function(e){a[e]=a[t[e]]})),a}function Ze(n,r){return e.minBy(e.values(r),(function(r){var t=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return e.forIn(r,(function(e,r){var i=function(e,n){return e.node(n).width}(n,r)/2;t=Math.max(e+i,t),o=Math.min(e-i,o)})),t-o}))}function $e(n,r){var t=e.values(r),o=e.min(t),i=e.max(t);e.forEach(["u","d"],(function(t){e.forEach(["l","r"],(function(a){var s,u=t+a,d=n[u];if(d!==r){var c=e.values(d);(s="l"===a?o-e.min(c):i-e.max(c))&&(n[u]=e.mapValues(d,(function(e){return e+s})))}}))}))}function en(n,r){return e.mapValues(n.ul,(function(t,o){if(r)return n[r.toLowerCase()][o];var i=e.sortBy(e.map(n,o));return(i[1]+i[2])/2}))}var nn=Ae;function rn(n){(function(n){var r=A.buildLayerMatrix(n),t=n.graph().ranksep,o=0;e.forEach(r,(function(r){var i=e.max(e.map(r,(function(e){return n.node(e).height})));e.forEach(r,(function(e){n.node(e).y=o+i/2})),o+=i+t}))})(n=A.asNonCompoundGraph(n)),e.forEach(nn(n),(function(e,r){n.node(r).x=e}))}var tn=m.Graph;var on=["nodesep","edgesep","ranksep","marginx","marginy"],an={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},sn=["acyclicer","ranker","rankdir","align"],un=["width","height"],dn={width:0,height:0},cn=["minlen","weight","width","height","labeloffset"],hn={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},fn=["labelpos"];function gn(n,r){return e.mapValues(e.pick(n,r),Number)}function vn(n){var r={};return e.forEach(n,(function(e,n){r[n.toLowerCase()]=e})),r}var ln=m.Graph;var pn={debugOrdering:function(n){var r=A.buildLayerMatrix(n),t=new ln({compound:!0,multigraph:!0}).setGraph({});return e.forEach(n.nodes(),(function(e){t.setNode(e,{label:e}),t.setParent(e,"layer"+n.node(e).rank)})),e.forEach(n.edges(),(function(e){t.setEdge(e.v,e.w,{},e.name)})),e.forEach(r,(function(n,r){var o="layer"+r;t.setNode(o,{rank:"same"}),e.reduce(n,(function(e,n){return t.setEdge(e,n,{style:"invis"}),n}))})),t}},mn={graphlib:D,layout:function(n,r){var t=r&&r.debugTiming?A.time:A.notime;t("layout",(function(){var r=t("  buildLayoutGraph",(function(){return function(n){var r=new tn({multigraph:!0,compound:!0}),t=vn(n.graph());return r.setGraph(e.merge({},an,gn(t,on),e.pick(t,sn))),e.forEach(n.nodes(),(function(t){var o=vn(n.node(t));r.setNode(t,e.defaults(gn(o,un),dn)),r.setParent(t,n.parent(t))})),e.forEach(n.edges(),(function(t){var o=vn(n.edge(t));r.setEdge(t,e.merge({},hn,gn(o,cn),e.pick(o,fn)))})),r}(n)}));t("  runLayout",(function(){!function(n,r){r("    makeSpaceForEdgeLabels",(function(){!function(n){var r=n.graph();r.ranksep/=2,e.forEach(n.edges(),(function(e){var t=n.edge(e);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===r.rankdir||"BT"===r.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)}))}(n)})),r("    removeSelfEdges",(function(){!function(n){e.forEach(n.edges(),(function(e){if(e.v===e.w){var r=n.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:e,label:n.edge(e)}),n.removeEdge(e)}}))}(n)})),r("    acyclic",(function(){q.run(n)})),r("    nestingGraph.run",(function(){xe.run(n)})),r("    rank",(function(){_e(A.asNonCompoundGraph(n))})),r("    injectEdgeLabelProxies",(function(){!function(n){e.forEach(n.edges(),(function(e){var r=n.edge(e);if(r.width&&r.height){var t=n.node(e.v),o={rank:(n.node(e.w).rank-t.rank)/2+t.rank,e:e};A.addDummyNode(n,"edge-proxy",o,"_ep")}}))}(n)})),r("    removeEmptyRanks",(function(){Q(n)})),r("    nestingGraph.cleanup",(function(){xe.cleanup(n)})),r("    normalizeRanks",(function(){K(n)})),r("    assignRankMinMax",(function(){!function(n){var r=0;e.forEach(n.nodes(),(function(t){var o=n.node(t);o.borderTop&&(o.minRank=n.node(o.borderTop).rank,o.maxRank=n.node(o.borderBottom).rank,r=e.max(r,o.maxRank))})),n.graph().maxRank=r}(n)})),r("    removeEdgeLabelProxies",(function(){!function(n){e.forEach(n.nodes(),(function(e){var r=n.node(e);"edge-proxy"===r.dummy&&(n.edge(r.e).labelRank=r.rank,n.removeNode(e))}))}(n)})),r("    normalize.run",(function(){$.run(n)})),r("    parentDummyChains",(function(){ke(n)})),r("    addBorderSegments",(function(){!function(n){e.forEach(n.children(),(function r(t){var o=n.children(t),i=n.node(t);if(o.length&&e.forEach(o,r),e.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)Ie(n,"borderLeft","_bl",t,i,a),Ie(n,"borderRight","_br",t,i,a)}}))}(n)})),r("    order",(function(){Ve(n)})),r("    insertSelfEdges",(function(){!function(n){var r=A.buildLayerMatrix(n);e.forEach(r,(function(r){var t=0;e.forEach(r,(function(r,o){var i=n.node(r);i.order=o+t,e.forEach(i.selfEdges,(function(e){A.addDummyNode(n,"selfedge",{width:e.label.width,height:e.label.height,rank:i.rank,order:o+ ++t,e:e.e,label:e.label},"_se")})),delete i.selfEdges}))}))}(n)})),r("    adjustCoordinateSystem",(function(){Te.adjust(n)})),r("    position",(function(){rn(n)})),r("    positionSelfEdges",(function(){!function(n){e.forEach(n.nodes(),(function(e){var r=n.node(e);if("selfedge"===r.dummy){var t=n.node(r.e.v),o=t.x+t.width/2,i=t.y,a=r.x-o,s=t.height/2;n.setEdge(r.e,r.label),n.removeNode(e),r.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.label.x=r.x,r.label.y=r.y}}))}(n)})),r("    removeBorderNodes",(function(){!function(n){e.forEach(n.nodes(),(function(r){if(n.children(r).length){var t=n.node(r),o=n.node(t.borderTop),i=n.node(t.borderBottom),a=n.node(e.last(t.borderLeft)),s=n.node(e.last(t.borderRight));t.width=Math.abs(s.x-a.x),t.height=Math.abs(i.y-o.y),t.x=a.x+t.width/2,t.y=o.y+t.height/2}})),e.forEach(n.nodes(),(function(e){"border"===n.node(e).dummy&&n.removeNode(e)}))}(n)})),r("    normalize.undo",(function(){$.undo(n)})),r("    fixupEdgeLabelCoords",(function(){!function(n){e.forEach(n.edges(),(function(r){var t=n.edge(r);if(e.has(t,"x"))switch("l"!==t.labelpos&&"r"!==t.labelpos||(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset}}))}(n)})),r("    undoCoordinateSystem",(function(){Te.undo(n)})),r("    translateGraph",(function(){!function(n){var r=Number.POSITIVE_INFINITY,t=0,o=Number.POSITIVE_INFINITY,i=0,a=n.graph(),s=a.marginx||0,u=a.marginy||0;function d(e){var n=e.x,a=e.y,s=e.width,u=e.height;r=Math.min(r,n-s/2),t=Math.max(t,n+s/2),o=Math.min(o,a-u/2),i=Math.max(i,a+u/2)}e.forEach(n.nodes(),(function(e){d(n.node(e))})),e.forEach(n.edges(),(function(r){var t=n.edge(r);e.has(t,"x")&&d(t)})),r-=s,o-=u,e.forEach(n.nodes(),(function(e){var t=n.node(e);t.x-=r,t.y-=o})),e.forEach(n.edges(),(function(t){var i=n.edge(t);e.forEach(i.points,(function(e){e.x-=r,e.y-=o})),e.has(i,"x")&&(i.x-=r),e.has(i,"y")&&(i.y-=o)})),a.width=t-r+s,a.height=i-o+u}(n)})),r("    assignNodeIntersects",(function(){!function(n){e.forEach(n.edges(),(function(e){var r,t,o=n.edge(e),i=n.node(e.v),a=n.node(e.w);o.points?(r=o.points[0],t=o.points[o.points.length-1]):(o.points=[],r=a,t=i),o.points.unshift(A.intersectRect(i,r)),o.points.push(A.intersectRect(a,t))}))}(n)})),r("    reversePoints",(function(){!function(n){e.forEach(n.edges(),(function(e){var r=n.edge(e);r.reversed&&r.points.reverse()}))}(n)})),r("    acyclic.undo",(function(){q.undo(n)}))}(r,t)})),t("  updateInputGraph",(function(){!function(n,r){e.forEach(n.nodes(),(function(e){var t=n.node(e),o=r.node(e);t&&(t.x=o.x,t.y=o.y,r.children(e).length&&(t.width=o.width,t.height=o.height))})),e.forEach(n.edges(),(function(t){var o=n.edge(t),i=r.edge(t);o.points=i.points,e.has(i,"x")&&(o.x=i.x,o.y=i.y)})),n.graph().width=r.graph().width,n.graph().height=r.graph().height}(n,r)}))}))},debug:pn,util:{time:X,notime:Z}};export default mn;
