this.dagre=function(e){"use strict";var n="default"in e?e.default:e;class r{constructor(n={}){this._nodes={},this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={},this._nodeCount=0,this._edgeCount=0,this._isDirected=!e.has(n,"directed")||n.directed,this._isMultigraph=!!e.has(n,"multigraph")&&n.multigraph,this._isCompound=!!e.has(n,"compound")&&n.compound,this._isCompound&&(this._parent={},this._children={},this._children["\0"]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(n){return e.isFunction(n)||(n=e.constant(n)),this._defaultNodeLabelFn=n,this}nodeCount(){return this._nodeCount}nodes(){return e.keys(this._nodes)}sources(){var n=this;return e.filter(this.nodes(),(function(r){return e.isEmpty(n._in[r])}))}sinks(){var n=this;return e.filter(this.nodes(),(function(r){return e.isEmpty(n._out[r])}))}setNodes(n,r){var t=arguments,o=this;return e.each(n,(function(e){t.length>1?o.setNode(e,r):o.setNode(e)})),this}setNode(n,r){if(e.has(this._nodes,n))return arguments.length>1&&(this._nodes[n]=r),this;let t=this._defaultNodeLabelFn||function(e){return e};return this._nodes[n]=arguments.length>1?r:t(n),this._isCompound&&(this._parent[n]="\0",this._children[n]={},this._children["\0"][n]=!0),this._in[n]={},this._preds[n]={},this._out[n]={},this._sucs[n]={},++this._nodeCount,this}node(e){return this._nodes[e]}hasNode(n){return e.has(this._nodes,n)}removeNode(n){var r=this;if(e.has(this._nodes,n)){var t=function(e){r.removeEdge(r._edgeObjs[e])};delete this._nodes[n],this._isCompound&&(this._removeFromParentsChildList(n),delete this._parent[n],e.each(this.children(n),(function(e){r.setParent(e)})),delete this._children[n]),e.each(e.keys(this._in[n]),t),delete this._in[n],delete this._preds[n],e.each(e.keys(this._out[n]),t),delete this._out[n],delete this._sucs[n],--this._nodeCount}return this}setParent(n,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(r))r="\0";else{for(var t=r+="";!e.isUndefined(t);t=this.parent(t))if(t===n)throw new Error("Setting "+r+" as parent of "+n+" would create a cycle");this.setNode(r)}return this.setNode(n),this._removeFromParentsChildList(n),this._parent[n]=r,this._children[r][n]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var n=this._parent[e];if("\0"!==n)return n}}children(n){if(e.isUndefined(n)&&(n="\0"),this._isCompound){var r=this._children[n];if(r)return e.keys(r)}else{if("\0"===n)return this.nodes();if(this.hasNode(n))return[]}return[]}predecessors(n){var r=this._preds[n];return r?e.keys(r):[]}successors(n){var r=this._sucs[n];return r?e.keys(r):[]}neighbors(n){var r=this.predecessors(n);if(r)return e.union(r,this.successors(n))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(n){var t=new r({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var o=this;e.each(this._nodes,(function(e,r){n(r)&&t.setNode(r,e)})),e.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,o.edge(e))}));var i={};function a(e){var n=o.parent(e);return void 0===n||t.hasNode(n)?(i[e]=n,n):n in i?i[n]:a(n)}return this._isCompound&&e.each(t.nodes(),(function(e){t.setParent(e,a(e))})),t}setDefaultEdgeLabel(n){return e.isFunction(n)||(n=e.constant(n)),this._defaultEdgeLabelFn=n,this}edgeCount(){return this._edgeCount}edges(){return e.values(this._edgeObjs)}setPath(n,r){var t=this,o=arguments;return e.reduce(n,(function(e,n){return o.length>1?t.setEdge(e,n,r):t.setEdge(e,n),n})),this}setEdge(n,r,o,a){var s,u,d,c,h=!1,f=arguments[0];"object"==typeof f&&null!==f&&"v"in f?(s=f.v,u=f.w,d=f.name,2===arguments.length&&(c=arguments[1],h=!0)):(s=f,u=arguments[1],d=arguments[3],arguments.length>2&&(c=arguments[2],h=!0)),s=""+s,u=""+u,e.isUndefined(d)||(d=""+d);var g=i(this._isDirected,s,u,d);if(e.has(this._edgeLabels,g))return h&&(this._edgeLabels[g]=c),this;if(!e.isUndefined(d)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(s),this.setNode(u),this._edgeLabels[g]=h?c:this._defaultEdgeLabelFn(s,u,d);var v=function(e,n,r,t){var o=""+n,i=""+r;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};return t&&(s.name=t),s}(this._isDirected,s,u,d);return s=v.v,u=v.w,Object.freeze(v),this._edgeObjs[g]=v,t(this._preds[u],s),t(this._sucs[s],u),this._in[u][g]=v,this._out[s][g]=v,this._edgeCount++,this}edge(e,n,r){var t=1===arguments.length?a(this._isDirected,arguments[0]):i(this._isDirected,e,n,r);return this._edgeLabels[t]}hasEdge(n,r,t){var o=1===arguments.length?a(this._isDirected,arguments[0]):i(this._isDirected,n,r,t);return e.has(this._edgeLabels,o)}removeEdge(e,n,r){var t=1===arguments.length?a(this._isDirected,arguments[0]):i(this._isDirected,e,n,r),s=this._edgeObjs[t];if(s){const e=s.v,n=s.w;delete this._edgeLabels[t],delete this._edgeObjs[t],o(this._preds[n],e),o(this._sucs[e],n),delete this._in[n][t],delete this._out[e][t],this._edgeCount--}return this}inEdges(n,r){var t=this._in[n];if(t){var o=e.values(t);return r?e.filter(o,(function(e){return e.v===r})):o}}outEdges(n,r){var t=this._out[n];if(t){var o=e.values(t);return r?e.filter(o,(function(e){return e.w===r})):o}}nodeEdges(e,n){var r=this.inEdges(e,n);if(r)return r.concat(this.outEdges(e,n))}}function t(e,n){e[n]?e[n]++:e[n]=1}function o(e,n){--e[n]||delete e[n]}function i(n,r,t,o){var i=""+r,a=""+t;if(!n&&i>a){var s=i;i=a,a=s}return i+""+a+""+(e.isUndefined(o)?"\0":o)}function a(e,n){return i(e,n.v,n.w,n.name)}var s={Graph:r};class u{constructor(){this._arr=[],this._keyIndices={}}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(n){return e.has(this._keyIndices,n)}priority(e){var n=this._keyIndices[e];if(void 0!==n)return this._arr[n].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(n,r){var t=this._keyIndices;if(n=String(n),!e.has(t,n)){var o=this._arr,i=o.length;return t[n]=i,o.push({key:n,priority:r}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,n){var r=this._keyIndices[e];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(e){var n=this._arr,r=2*e,t=r+1,o=e;r<n.length&&(o=n[r].priority<n[o].priority?r:o,t<n.length&&(o=n[t].priority<n[o].priority?t:o),o!==e&&(this._swap(e,o),this._heapify(o)))}_decrease(e){for(var n,r=this._arr,t=r[e].priority;0!==e&&!(r[n=e>>1].priority<t);)this._swap(e,n),e=n}_swap(e,n){var r=this._arr,t=this._keyIndices,o=r[e],i=r[n];r[e]=i,r[n]=o,t[i.key]=e,t[o.key]=n}}var d=e.constant(1);function c(e,n,r,t){return function(e,n,r,t){var o,i,a={},s=new u,d=function(e){var n=e.v!==o?e.v:e.w,t=a[n],u=r(e),d=i.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+u);d<t.distance&&(t.distance=d,t.predecessor=o,s.decrease(n,d))};for(e.nodes().forEach((function(e){var r=e===n?0:Number.POSITIVE_INFINITY;a[e]={distance:r},s.add(e,r)}));s.size()>0&&(o=s.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)t(o).forEach(d);return a}(e,String(n),r||d,t||function(n){return e.outEdges(n)})}function h(n){var r=0,t=[],o={},i=[];function a(s){var u=o[s]={onStack:!0,lowlink:r,index:r++};if(t.push(s),n.successors(s).forEach((function(n){e.has(o,n)?o[n].onStack&&(u.lowlink=Math.min(u.lowlink,o[n].index)):(a(n),u.lowlink=Math.min(u.lowlink,o[n].lowlink))})),u.lowlink===u.index){var d,c=[];do{d=t.pop(),o[d].onStack=!1,c.push(d)}while(s!==d);i.push(c)}}return n.nodes().forEach((function(n){e.has(o,n)||a(n)})),i}var f=e.constant(1);function g(n){var r={},t={},o=[];if(e.each(n.sinks(),(function i(a){if(e.has(t,a))throw new v;e.has(r,a)||(t[a]=!0,r[a]=!0,e.each(n.predecessors(a),i),delete t[a],o.push(a))})),e.size(r)!==n.nodeCount())throw new v;return o}function v(){}function l(n,r,t){e.isArray(r)||(r=[r]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),i=[],a={};return e.each(r,(function(e){if(!n.hasNode(e))throw new Error("Graph does not have node: "+e);p(n,e,"post"===t,a,o,i)})),i}function p(n,r,t,o,i,a){e.has(o,r)||(o[r]=!0,t||a.push(r),e.each(i(r),(function(e){p(n,e,t,o,i,a)})),t&&a.push(r))}function m(n){return e.map(n.nodes(),(function(r){var t=n.node(r),o=n.parent(r),i={v:r};return e.isUndefined(t)||(i.value=t),e.isUndefined(o)||(i.parent=o),i}))}function E(n){return e.map(n.edges(),(function(r){var t=n.edge(r),o={v:r.v,w:r.w};return e.isUndefined(r.name)||(o.name=r.name),e.isUndefined(t)||(o.value=t),o}))}g.CycleException=v,v.prototype=new Error;var w={Graph:s.Graph,json:{read:function(n){var t=new r(n.options).setGraph(n.value);return e.each(n.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),e.each(n.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t},write:function(n){var r={options:{directed:n.isDirected(),multigraph:n.isMultigraph(),compound:n.isCompound()},nodes:m(n),edges:E(n)};return e.isUndefined(n.graph())||(r.value=e.clone(n.graph())),r}},alg:{components:function(n){var r,t={},o=[];function i(o){e.has(t,o)||(t[o]=!0,r.push(o),e.each(n.successors(o),i),e.each(n.predecessors(o),i))}return e.each(n.nodes(),(function(e){r=[],i(e),r.length&&o.push(r)})),o},dijkstra:c,dijkstraAll:function(n,r,t){return e.transform(n.nodes(),(function(e,o){e[o]=c(n,o,r,t)}),{})},findCycles:function(n){return e.filter(h(n),(function(e){return e.length>1||1===e.length&&n.hasEdge(e[0],e[0])}))},isAcyclic:function(e){try{g(e)}catch(e){if(e instanceof g.CycleException)return!1;throw e}return!0},floydWarshall:function(e,n,r){return function(e,n,r){var t={},o=e.nodes();return o.forEach((function(e){t[e]={},t[e][e]={distance:0},o.forEach((function(n){e!==n&&(t[e][n]={distance:Number.POSITIVE_INFINITY})})),r(e).forEach((function(r){var o=r.v===e?r.w:r.v,i=n(r);t[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var n=t[e];o.forEach((function(r){var i=t[r];o.forEach((function(r){var t=i[e],o=n[r],a=i[r],s=t.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),t}(e,n||f,r||function(n){return e.outEdges(n)})},postorder:function(e,n){return l(e,n,"post")},preorder:function(e,n){return l(e,n,"pre")},prim:function(n,t){var o,i=new r,a={},s=new u;function d(e){var n=e.v===o?e.w:e.v,r=s.priority(n);if(void 0!==r){var i=t(e);i<r&&(a[n]=o,s.decrease(n,i))}}if(0===n.nodeCount())return i;e.each(n.nodes(),(function(e){s.add(e,Number.POSITIVE_INFINITY),i.setNode(e)})),s.decrease(n.nodes()[0],0);for(var c=!1;s.size()>0;){if(o=s.removeMin(),e.has(a,o))i.setEdge(o,a[o]);else{if(c)throw new Error("Input graph is not connected: "+n);c=!0}n.nodeEdges(o).forEach(d)}return i},tarjan:h,topsort:g},version:s.version};function y(){var e={};e._next=e._prev=e,this._sentinel=e}function _(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function b(e,n){if("_next"!==e&&"_prev"!==e)return n}y.prototype.dequeue=function(){var e=this._sentinel,n=e._prev;if(n!==e)return _(n),n},y.prototype.enqueue=function(e){var n=this._sentinel;e._prev&&e._next&&_(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n},y.prototype.toString=function(){for(var e=[],n=this._sentinel,r=n._prev;r!==n;)e.push(JSON.stringify(r,b)),r=r._prev;return"["+e.join(", ")+"]"};var k=w.Graph;function N(e,r){if(e.nodeCount()<=1)return[];var t=function(e,r){var t=new k,o=0,i=0;n.forEach(e.nodes(),(function(e){t.setNode(e,{v:e,in:0,out:0})})),n.forEach(e.edges(),(function(e){var n=t.edge(e.v,e.w)||0,a=r(e),s=n+a;t.setEdge(e.v,e.w,s),i=Math.max(i,t.node(e.v).out+=a),o=Math.max(o,t.node(e.w).in+=a)}));var a=n.range(i+o+3).map((function(){return new y})),s=o+1;return n.forEach(t.nodes(),(function(e){I(a,s,t.node(e))})),{graph:t,buckets:a,zeroIdx:s}}(e,r||1),o=function(e,n,r){var t,o=[],i=n[n.length-1],a=n[0];for(;e.nodeCount();){for(;t=a.dequeue();)x(e,n,r,t);for(;t=i.dequeue();)x(e,n,r,t);if(e.nodeCount())for(var s=n.length-2;s>0;--s)if(t=n[s].dequeue()){o=o.concat(x(e,n,r,t,!0));break}}return o}(t.graph,t.buckets,t.zeroIdx);return n.flatten(n.map(o,(function(n){return e.outEdges(n.v,n.w)})),!0)}function x(e,r,t,o,i){var a=i?[]:void 0;return n.forEach(e.inEdges(o.v),(function(n){var o=e.edge(n),s=e.node(n.v);i&&a.push({v:n.v,w:n.w}),s.out-=o,I(r,t,s)})),n.forEach(e.outEdges(o.v),(function(n){var o=e.edge(n),i=n.w,a=e.node(i);a.in-=o,I(r,t,a)})),e.removeNode(o.v),a}function I(e,n,r){r.out?r.in?e[r.out-r.in+n].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var C={run:function(e){var r="greedy"===e.graph().acyclicer?N(e,function(e){return function(n){return e.edge(n).weight}}(e)):function(e){var r=[],t={},o={};function i(a){n.has(o,a)||(o[a]=!0,t[a]=!0,n.forEach(e.outEdges(a),(function(e){n.has(t,e.w)?r.push(e):i(e.w)})),delete t[a])}return n.forEach(e.nodes(),i),r}(e);n.forEach(r,(function(r){var t=e.edge(r);e.removeEdge(r),t.forwardName=r.name,t.reversed=!0,e.setEdge(r.w,r.v,t,n.uniqueId("rev"))}))},undo:function(e){n.forEach(e.edges(),(function(n){var r=e.edge(n);if(r.reversed){e.removeEdge(n);var t=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(n.w,n.v,r,t)}}))}},L=w.Graph,M={addDummyNode:R,simplify:T,asNonCompoundGraph:function(e){var r=new L({multigraph:e.isMultigraph()}).setGraph(e.graph());return n.forEach(e.nodes(),(function(n){e.children(n).length||r.setNode(n,e.node(n))})),n.forEach(e.edges(),(function(n){r.setEdge(n,e.edge(n))})),r},successorWeights:function(e){var r=n.map(e.nodes(),(function(r){var t={};return n.forEach(e.outEdges(r),(function(n){t[n.w]=(t[n.w]||0)+e.edge(n).weight})),t}));return n.zipObject(e.nodes(),r)},predecessorWeights:function(e){var r=n.map(e.nodes(),(function(r){var t={};return n.forEach(e.inEdges(r),(function(n){t[n.v]=(t[n.v]||0)+e.edge(n).weight})),t}));return n.zipObject(e.nodes(),r)},intersectRect:function(e,n){var r,t,o=e.x,i=e.y,a=n.x-o,s=n.y-i,u=e.width/2,d=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,t=d):(a<0&&(u=-u),r=u,t=u*s/a);return{x:o+r,y:i+t}},buildLayerMatrix:function(e){var r=n.map(n.range(O(e)+1),(function(){return[]}));return n.forEach(e.nodes(),(function(t){var o=e.node(t),i=o.rank;n.isUndefined(i)||(r[i][o.order]=t)})),r},normalizeRanks:G,removeEmptyRanks:P,addBorderNode:function(e,n,r,t){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=t);return R(e,"border",o,n)},maxRank:O,partition:function(e,r){var t={lhs:[],rhs:[]};return n.forEach(e,(function(e){r(e)?t.lhs.push(e):t.rhs.push(e)})),t},time:D,notime:S};function R(e,r,t,o){var i;do{i=n.uniqueId(o)}while(e.hasNode(i));return t.dummy=r,e.setNode(i,t),i}function T(e){var r=(new L).setGraph(e.graph());return n.forEach(e.nodes(),(function(n){r.setNode(n,e.node(n))})),n.forEach(e.edges(),(function(n){var t=r.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);r.setEdge(n.v,n.w,{weight:t.weight+o.weight,minlen:Math.max(t.minlen,o.minlen)})})),r}function G(e){var r=n.min(n.map(e.nodes(),(function(n){return e.node(n).rank})));n.forEach(e.nodes(),(function(t){var o=e.node(t);n.has(o,"rank")&&(o.rank-=r)}))}function P(e){var r=n.min(n.map(e.nodes(),(function(n){return e.node(n).rank}))),t=[];n.forEach(e.nodes(),(function(n){var o=e.node(n).rank-r;t[o]||(t[o]=[]),t[o].push(n)}));var o=0,i=e.graph().nodeRankFactor;n.forEach(t,(function(r,t){n.isUndefined(r)&&t%i!=0?--o:o&&n.forEach(r,(function(n){e.node(n).rank+=o}))}))}function O(e){return n.max(n.map(e.nodes(),(function(r){var t=e.node(r).rank;if(!n.isUndefined(t))return t})))}function D(e,r){var t=n.now();try{return r()}finally{console.log(e+" time: "+(n.now()-t)+"ms")}}function S(e,n){return n()}var j={run:function(e){e.graph().dummyChains=[],n.forEach(e.edges(),(function(n){!function(e,n){var r,t,o,i=n.v,a=e.node(i).rank,s=n.w,u=e.node(s).rank,d=n.name,c=e.edge(n),h=c.labelRank;if(u===a+1)return;for(e.removeEdge(n),o=0,++a;a<u;++o,++a)c.points=[],t={width:0,height:0,edgeLabel:c,edgeObj:n,rank:a},r=M.addDummyNode(e,"edge",t,"_d"),a===h&&(t.width=c.width,t.height=c.height,t.dummy="edge-label",t.labelpos=c.labelpos),e.setEdge(i,r,{weight:c.weight},d),0===o&&e.graph().dummyChains.push(r),i=r;e.setEdge(i,s,{weight:c.weight},d)}(e,n)}))},undo:function(e){n.forEach(e.graph().dummyChains,(function(n){var r,t=e.node(n),o=t.edgeLabel;for(e.setEdge(t.edgeObj,o);t.dummy;)r=e.successors(n)[0],e.removeNode(n),o.points.push({x:t.x,y:t.y}),"edge-label"===t.dummy&&(o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height),n=r,t=e.node(n)}))}};function F(e){var r={};n.forEach(e.sources(),(function t(o){var i=e.node(o);if(n.has(r,o))return i.rank;r[o]=!0;var a=n.min(n.map(e.outEdges(o),(function(n){return t(n.w)-e.edge(n).minlen})));return a!==Number.POSITIVE_INFINITY&&null!=a||(a=0),i.rank=a}))}function B(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen}var U=F,V=w.Graph;function z(e){var n,r,t=new V({directed:!1}),o=e.nodes()[0],i=e.nodeCount();for(t.setNode(o,{});Y(t,e)<i;)n=q(t,e),r=t.hasNode(n.v)?B(e,n):-B(e,n),A(t,e,r);return t}function Y(e,r){return n.forEach(e.nodes(),(function t(o){n.forEach(r.nodeEdges(o),(function(n){var i=n.v,a=o===i?n.w:i;e.hasNode(a)||B(r,n)||(e.setNode(a,{}),e.setEdge(o,a,{}),t(a))}))})),e.nodeCount()}function q(e,r){return n.minBy(r.edges(),(function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return B(r,n)}))}function A(e,r,t){n.forEach(e.nodes(),(function(e){r.node(e).rank+=t}))}var W=w.alg.preorder,J=w.alg.postorder;function K(e){F(e=T(e));var n,r=z(e);for(X(r),Q(r,e);n=$(r);)ne(r,e,n,ee(r,e,n))}function Q(e,r){var t=J(e,e.nodes());t=t.slice(0,t.length-1),n.forEach(t,(function(n){!function(e,n,r){var t=e.node(r).parent;e.edge(r,t).cutvalue=H(e,n,r)}(e,r,n)}))}function H(e,r,t){var o=e.node(t).parent,i=!0,a=r.edge(t,o),s=0;return a||(i=!1,a=r.edge(o,t)),s=a.weight,n.forEach(r.nodeEdges(t),(function(n){var a=n.v===t,u=a?n.w:n.v;if(u!==o){var d=a===i,c=r.edge(n).weight;if(s+=d?c:-c,function(e,n,r){return e.hasEdge(n,r)}(e,t,u)){var h=e.edge(t,u).cutvalue;s+=d?-h:h}}})),s}function X(e,n){arguments.length<2&&(n=e.nodes()[0]),Z(e,{},1,n)}function Z(e,r,t,o,i){var a=t,s=e.node(o);return r[o]=!0,n.forEach(e.neighbors(o),(function(i){n.has(r,i)||(t=Z(e,r,t,i,o))})),s.low=a,s.lim=t++,i?s.parent=i:delete s.parent,t}function $(e){return n.find(e.edges(),(function(n){return e.edge(n).cutvalue<0}))}function ee(e,r,t){var o=t.v,i=t.w;r.hasEdge(o,i)||(o=t.w,i=t.v);var a=e.node(o),s=e.node(i),u=a,d=!1;a.lim>s.lim&&(u=s,d=!0);var c=n.filter(r.edges(),(function(n){return d===re(e,e.node(n.v),u)&&d!==re(e,e.node(n.w),u)}));return n.minBy(c,(function(e){return B(r,e)}))}function ne(e,r,t,o){var i=t.v,a=t.w;e.removeEdge(i,a),e.setEdge(o.v,o.w,{}),X(e),Q(e,r),function(e,r){var t=n.find(e.nodes(),(function(e){return!r.node(e).parent})),o=W(e,t);o=o.slice(1),n.forEach(o,(function(n){var t=e.node(n).parent,o=r.edge(n,t),i=!1;o||(o=r.edge(t,n),i=!0),r.node(n).rank=r.node(t).rank+(i?o.minlen:-o.minlen)}))}(e,r)}function re(e,n,r){return r.low<=n.lim&&n.lim<=r.lim}K.initLowLimValues=X,K.initCutValues=Q,K.calcCutValue=H,K.leaveEdge=$,K.enterEdge=ee,K.exchangeEdges=ne;var te=U;function oe(e){switch(e.graph().ranker){case"network-simplex":default:ae(e);break;case"tight-tree":!function(e){te(e),z(e)}(e);break;case"longest-path":ie(e)}}var ie=te;function ae(e){K(e)}function se(e){var r=function(e){var r={},t=0;function o(i){var a=t;n.forEach(e.children(i),o),r[i]={low:a,lim:t++}}return n.forEach(e.children(),o),r}(e);n.forEach(e.graph().dummyChains,(function(n){for(var t=e.node(n),o=t.edgeObj,i=function(e,n,r,t){var o,i,a=[],s=[],u=Math.min(n[r].low,n[t].low),d=Math.max(n[r].lim,n[t].lim);o=r;do{o=e.parent(o),a.push(o)}while(o&&(n[o].low>u||d>n[o].lim));i=o,o=t;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,r,o.v,o.w),a=i.path,s=i.lca,u=0,d=a[u],c=!0;n!==o.w;){if(t=e.node(n),c){for(;(d=a[u])!==s&&e.node(d).maxRank<t.rank;)u++;d===s&&(c=!1)}if(!c){for(;u<a.length-1&&e.node(d=a[u+1]).minRank<=t.rank;)u++;d=a[u]}e.setParent(n,d),n=e.successors(n)[0]}}))}function ue(e,r,t,o,i,a,s){var u=e.children(s);if(u.length){var d=M.addBorderNode(e,"_bt"),c=M.addBorderNode(e,"_bb"),h=e.node(s);e.setParent(d,s),h.borderTop=d,e.setParent(c,s),h.borderBottom=c,n.forEach(u,(function(n){ue(e,r,t,o,i,a,n);var u=e.node(n),h=u.borderTop?u.borderTop:n,f=u.borderBottom?u.borderBottom:n,g=u.borderTop?o:2*o,v=h!==f?1:i-a[s]+1;e.setEdge(d,h,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(f,c,{weight:g,minlen:v,nestingEdge:!0})})),e.parent(s)||e.setEdge(r,d,{weight:0,minlen:i+a[s]})}else s!==r&&e.setEdge(r,s,{weight:0,minlen:t})}var de={run:function(e){var r=M.addDummyNode(e,"root",{},"_root"),t=function(e){var r={};function t(o,i){var a=e.children(o);a&&a.length&&n.forEach(a,(function(e){t(e,i+1)})),r[o]=i}return n.forEach(e.children(),(function(e){t(e,1)})),r}(e),o=n.max(n.values(t))-1,i=2*o+1;e.graph().nestingRoot=r,n.forEach(e.edges(),(function(n){e.edge(n).minlen*=i}));var a=function(e){return n.reduce(e.edges(),(function(n,r){return n+e.edge(r).weight}),0)}(e)+1;n.forEach(e.children(),(function(n){ue(e,r,i,a,o,t,n)})),e.graph().nodeRankFactor=i},cleanup:function(e){var r=e.graph();e.removeNode(r.nestingRoot),delete r.nestingRoot,n.forEach(e.edges(),(function(n){e.edge(n).nestingEdge&&e.removeEdge(n)}))}};function ce(e,n,r,t,o,i){var a={width:0,height:0,rank:i,borderType:n},s=o[n][i-1],u=M.addDummyNode(e,"border",a,r);o[n][i]=u,e.setParent(u,t),s&&e.setEdge(s,u,{weight:1})}function he(e){n.forEach(e.nodes(),(function(n){fe(e.node(n))})),n.forEach(e.edges(),(function(n){fe(e.edge(n))}))}function fe(e){var n=e.width;e.width=e.height,e.height=n}function ge(e){e.y=-e.y}function ve(e){var n=e.x;e.x=e.y,e.y=n}var le={adjust:function(e){var n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||he(e)},undo:function(e){var r=e.graph().rankdir.toLowerCase();"bt"!==r&&"rl"!==r||function(e){n.forEach(e.nodes(),(function(n){ge(e.node(n))})),n.forEach(e.edges(),(function(r){var t=e.edge(r);n.forEach(t.points,ge),n.has(t,"y")&&ge(t)}))}(e),"lr"!==r&&"rl"!==r||(!function(e){n.forEach(e.nodes(),(function(n){ve(e.node(n))})),n.forEach(e.edges(),(function(r){var t=e.edge(r);n.forEach(t.points,ve),n.has(t,"x")&&ve(t)}))}(e),he(e))}};function pe(e,n){for(var r=0,t=1;t<n.length;++t)r+=me(e,n[t-1],n[t]);return r}function me(e,r,t){for(var o=n.zipObject(t,n.map(t,(function(e,n){return n}))),i=n.flatten(n.map(r,(function(r){return n.sortBy(n.map(e.outEdges(r),(function(n){return{pos:o[n.w],weight:e.edge(n).weight}})),"pos")})),!0),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var u=n.map(new Array(s),(function(){return 0})),d=0;return n.forEach(i.forEach((function(e){var n=e.pos+a;u[n]+=e.weight;for(var r=0;n>0;)n%2&&(r+=u[n+1]),u[n=n-1>>1]+=e.weight;d+=e.weight*r}))),d}function Ee(e,r){var t={};return n.forEach(e,(function(e,r){var o=t[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:r};n.isUndefined(e.barycenter)||(o.barycenter=e.barycenter,o.weight=e.weight)})),n.forEach(r.edges(),(function(e){var r=t[e.v],o=t[e.w];n.isUndefined(r)||n.isUndefined(o)||(o.indegree++,r.out.push(t[e.w]))})),function(e){var r=[];function t(e){return function(r){r.merged||(n.isUndefined(r.barycenter)||n.isUndefined(e.barycenter)||r.barycenter>=e.barycenter)&&function(e,n){var r=0,t=0;e.weight&&(r+=e.barycenter*e.weight,t+=e.weight);n.weight&&(r+=n.barycenter*n.weight,t+=n.weight);e.vs=n.vs.concat(e.vs),e.barycenter=r/t,e.weight=t,e.i=Math.min(n.i,e.i),n.merged=!0}(e,r)}}function o(n){return function(r){r.in.push(n),0==--r.indegree&&e.push(r)}}for(;e.length;){var i=e.pop();r.push(i),n.forEach(i.in.reverse(),t(i)),n.forEach(i.out,o(i))}return n.map(n.filter(r,(function(e){return!e.merged})),(function(e){return n.pick(e,["vs","i","barycenter","weight"])}))}(n.filter(t,(function(e){return!e.indegree})))}function we(e,r,t){for(var o;r.length&&(o=n.last(r)).i<=t;)r.pop(),e.push(o.vs),t++;return t}function ye(e,r,t,o){var i=e.children(r),a=e.node(r),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,d={};s&&(i=n.filter(i,(function(e){return e!==s&&e!==u})));var c=function(e,r){return n.map(r,(function(r){var t=e.inEdges(r);if(t.length){var o=n.reduce(t,(function(n,r){var t=e.edge(r),o=e.node(r.v);return{sum:n.sum+t.weight*o.order,weight:n.weight+t.weight}}),{sum:0,weight:0});return{v:r,barycenter:o.sum/o.weight,weight:o.weight}}return{v:r}}))}(e,i);n.forEach(c,(function(r){if(e.children(r.v).length){var i=ye(e,r.v,t,o);d[r.v]=i,n.has(i,"barycenter")&&(a=r,s=i,n.isUndefined(a.barycenter)?(a.barycenter=s.barycenter,a.weight=s.weight):(a.barycenter=(a.barycenter*a.weight+s.barycenter*s.weight)/(a.weight+s.weight),a.weight+=s.weight))}var a,s}));var h=Ee(c,t);!function(e,r){n.forEach(e,(function(e){e.vs=n.flatten(e.vs.map((function(e){return r[e]?r[e].vs:e})),!0)}))}(h,d);var f=function(e,r){var t,o=M.partition(e,(function(e){return n.has(e,"barycenter")})),i=o.lhs,a=n.sortBy(o.rhs,(function(e){return-e.i})),s=[],u=0,d=0,c=0;i.sort((t=!!r,function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i})),c=we(s,a,c),n.forEach(i,(function(e){c+=e.vs.length,s.push(e.vs),u+=e.barycenter*e.weight,d+=e.weight,c=we(s,a,c)}));var h={vs:n.flatten(s,!0)};return d&&(h.barycenter=u/d,h.weight=d),h}(h,o);if(s&&(f.vs=n.flatten([s,f.vs,u],!0),e.predecessors(s).length)){var g=e.node(e.predecessors(s)[0]),v=e.node(e.predecessors(u)[0]);n.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+g.order+v.order)/(f.weight+2),f.weight+=2}return f}var _e=w.Graph;function be(e,r,t){var o=function(e){var r;for(;e.hasNode(r=n.uniqueId("_root")););return r}(e),i=new _e({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(n){return e.node(n)}));return n.forEach(e.nodes(),(function(a){var s=e.node(a),u=e.parent(a);(s.rank===r||s.minRank<=r&&r<=s.maxRank)&&(i.setNode(a),i.setParent(a,u||o),n.forEach(e[t](a),(function(r){var t=r.v===a?r.w:r.v,o=i.edge(t,a),s=n.isUndefined(o)?0:o.weight;i.setEdge(t,a,{weight:e.edge(r).weight+s})})),n.has(s,"minRank")&&i.setNode(a,{borderLeft:s.borderLeft[r],borderRight:s.borderRight[r]}))})),i}var ke=w.Graph;function Ne(e){var r=M.maxRank(e),t=xe(e,n.range(1,r+1),"inEdges"),o=xe(e,n.range(r-1,-1,-1),"outEdges"),i=function(e){var r={},t=n.filter(e.nodes(),(function(n){return!e.children(n).length})),o=n.max(n.map(t,(function(n){return e.node(n).rank}))),i=n.map(n.range(o+1),(function(){return[]})),a=n.sortBy(t,(function(n){return e.node(n).rank}));return n.forEach(a,(function t(o){if(!n.has(r,o)){r[o]=!0;var a=e.node(o);i[a.rank].push(o),n.forEach(e.successors(o),t)}})),i}(e);Ce(e,i);for(var a,s=Number.POSITIVE_INFINITY,u=0,d=0;d<4;++u,++d){Ie(u%2?t:o,u%4>=2);var c=pe(e,i=M.buildLayerMatrix(e));c<s&&(d=0,a=n.cloneDeep(i),s=c)}Ce(e,a)}function xe(e,r,t){return n.map(r,(function(n){return be(e,n,t)}))}function Ie(e,r){var t=new ke;n.forEach(e,(function(e){var o=e.graph().root,i=ye(e,o,t,r);n.forEach(i.vs,(function(n,r){e.node(n).order=r})),function(e,r,t){var o,i={};n.forEach(t,(function(n){for(var t,a,s=e.parent(n);s;){if((t=e.parent(s))?(a=i[t],i[t]=s):(a=o,o=s),a&&a!==s)return void r.setEdge(a,s);s=t}}))}(e,t,i.vs)}))}function Ce(e,r){n.forEach(r,(function(r){n.forEach(r,(function(n,r){e.node(n).order=r}))}))}var Le=w.Graph,Me=function(e){var r,t=M.buildLayerMatrix(e),o=n.merge(Re(e,t),Te(e,t)),i={};n.forEach(["u","d"],(function(a){r="u"===a?t:n.values(t).reverse(),n.forEach(["l","r"],(function(t){"r"===t&&(r=n.map(r,(function(e){return n.values(e).reverse()})));var s=("u"===a?e.predecessors:e.successors).bind(e),u=Oe(e,r,o,s),d=De(e,r,u.root,u.align,"r"===t);"r"===t&&(d=n.mapValues(d,(function(e){return-e}))),i[a+t]=d}))}));var a=Se(e,i);return je(i,a),Fe(i,e.graph().align)};function Re(e,r){var t={};return n.reduce(r,(function(r,o){var i=0,a=0,s=r.length,u=n.last(o);return n.forEach(o,(function(r,d){var c=function(e,r){if(e.node(r).dummy)return n.find(e.predecessors(r),(function(n){return e.node(n).dummy}))}(e,r),h=c?e.node(c).order:s;(c||r===u)&&(n.forEach(o.slice(a,d+1),(function(r){n.forEach(e.predecessors(r),(function(n){var o=e.node(n),a=o.order;!(a<i||h<a)||o.dummy&&e.node(r).dummy||Ge(t,n,r)}))})),a=d+1,i=h)})),o})),t}function Te(e,r){var t={};function o(r,o,i,a,s){var u;n.forEach(n.range(o,i),(function(o){u=r[o],e.node(u).dummy&&n.forEach(e.predecessors(u),(function(n){var r=e.node(n);r.dummy&&(r.order<a||r.order>s)&&Ge(t,n,u)}))}))}return n.reduce(r,(function(r,t){var i,a=-1,s=0;return n.forEach(t,(function(n,u){if("border"===e.node(n).dummy){var d=e.predecessors(n);d.length&&(i=e.node(d[0]).order,o(t,s,u,a,i),s=u,a=i)}o(t,s,t.length,i,r.length)})),t})),t}function Ge(e,n,r){if(n>r){var t=n;n=r,r=t}var o=e[n];o||(e[n]=o={}),o[r]=!0}function Pe(e,r,t){if(r>t){var o=r;r=t,t=o}return n.has(e[r],t)}function Oe(e,r,t,o){var i={},a={},s={};return n.forEach(r,(function(e){n.forEach(e,(function(e,n){i[e]=e,a[e]=e,s[e]=n}))})),n.forEach(r,(function(e){var r=-1;n.forEach(e,(function(e){var u=o(e);if(u.length){u=n.sortBy(u,(function(e){return s[e]}));for(var d=(u.length-1)/2,c=Math.floor(d),h=Math.ceil(d);c<=h;++c){var f=u[c];a[e]===e&&r<s[f]&&!Pe(t,e,f)&&(a[f]=e,a[e]=i[e]=i[f],r=s[f])}}}))})),{root:i,align:a}}function De(e,r,t,o,i){var a={},s=function(e,r,t,o){var i=new Le,a=e.graph(),s=function(e,r,t){return function(o,i,a){var s,u=o.node(i),d=o.node(a),c=0;if(c+=u.width/2,n.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=-u.width/2;break;case"r":s=u.width/2}if(s&&(c+=t?s:-s),s=0,c+=(u.dummy?r:e)/2,c+=(d.dummy?r:e)/2,c+=d.width/2,n.has(d,"labelpos"))switch(d.labelpos.toLowerCase()){case"l":s=d.width/2;break;case"r":s=-d.width/2}return s&&(c+=t?s:-s),s=0,c}}(a.nodesep,a.edgesep,o);return n.forEach(r,(function(r){var o;n.forEach(r,(function(n){var r=t[n];if(i.setNode(r),o){var a=t[o],u=i.edge(a,r);i.setEdge(a,r,Math.max(s(e,n,o),u||0))}o=n}))})),i}(e,r,t,i),u=i?"borderLeft":"borderRight";function d(e,n){for(var r=s.nodes(),t=r.pop(),o={};t;)o[t]?e(t):(o[t]=!0,r.push(t),r=r.concat(n(t))),t=r.pop()}return d((function(e){a[e]=s.inEdges(e).reduce((function(e,n){return Math.max(e,a[n.v]+s.edge(n))}),0)}),s.predecessors.bind(s)),d((function(n){var r=s.outEdges(n).reduce((function(e,n){return Math.min(e,a[n.w]-s.edge(n))}),Number.POSITIVE_INFINITY),t=e.node(n);r!==Number.POSITIVE_INFINITY&&t.borderType!==u&&(a[n]=Math.max(a[n],r))}),s.successors.bind(s)),n.forEach(o,(function(e){a[e]=a[t[e]]})),a}function Se(e,r){return n.minBy(n.values(r),(function(r){var t=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return n.forIn(r,(function(n,r){var i=function(e,n){return e.node(n).width}(e,r)/2;t=Math.max(n+i,t),o=Math.min(n-i,o)})),t-o}))}function je(e,r){var t=n.values(r),o=n.min(t),i=n.max(t);n.forEach(["u","d"],(function(t){n.forEach(["l","r"],(function(a){var s,u=t+a,d=e[u];if(d!==r){var c=n.values(d);(s="l"===a?o-n.min(c):i-n.max(c))&&(e[u]=n.mapValues(d,(function(e){return e+s})))}}))}))}function Fe(e,r){return n.mapValues(e.ul,(function(t,o){if(r)return e[r.toLowerCase()][o];var i=n.sortBy(n.map(e,o));return(i[1]+i[2])/2}))}var Be=Me;function Ue(e){(function(e){var r=M.buildLayerMatrix(e),t=e.graph().ranksep,o=0;n.forEach(r,(function(r){var i=n.max(n.map(r,(function(n){return e.node(n).height})));n.forEach(r,(function(n){e.node(n).y=o+i/2})),o+=i+t}))})(e=M.asNonCompoundGraph(e)),n.forEach(Be(e),(function(n,r){e.node(r).x=n}))}var Ve=w.Graph;var ze=["nodesep","edgesep","ranksep","marginx","marginy"],Ye={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},qe=["acyclicer","ranker","rankdir","align"],Ae=["width","height"],We={width:0,height:0},Je=["minlen","weight","width","height","labeloffset"],Ke={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Qe=["labelpos"];function He(e,r){return n.mapValues(n.pick(e,r),Number)}function Xe(e){var r={};return n.forEach(e,(function(e,n){r[n.toLowerCase()]=e})),r}var Ze=w.Graph;var $e={debugOrdering:function(e){var r=M.buildLayerMatrix(e),t=new Ze({compound:!0,multigraph:!0}).setGraph({});return n.forEach(e.nodes(),(function(n){t.setNode(n,{label:n}),t.setParent(n,"layer"+e.node(n).rank)})),n.forEach(e.edges(),(function(e){t.setEdge(e.v,e.w,{},e.name)})),n.forEach(r,(function(e,r){var o="layer"+r;t.setNode(o,{rank:"same"}),n.reduce(e,(function(e,n){return t.setEdge(e,n,{style:"invis"}),n}))})),t}},en={graphlib:w,layout:function(e,r){var t=r&&r.debugTiming?M.time:M.notime;t("layout",(function(){var r=t("  buildLayoutGraph",(function(){return function(e){var r=new Ve({multigraph:!0,compound:!0}),t=Xe(e.graph());return r.setGraph(n.merge({},Ye,He(t,ze),n.pick(t,qe))),n.forEach(e.nodes(),(function(t){var o=Xe(e.node(t));r.setNode(t,n.defaults(He(o,Ae),We)),r.setParent(t,e.parent(t))})),n.forEach(e.edges(),(function(t){var o=Xe(e.edge(t));r.setEdge(t,n.merge({},Ke,He(o,Je),n.pick(o,Qe)))})),r}(e)}));t("  runLayout",(function(){!function(e,r){r("    makeSpaceForEdgeLabels",(function(){!function(e){var r=e.graph();r.ranksep/=2,n.forEach(e.edges(),(function(n){var t=e.edge(n);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===r.rankdir||"BT"===r.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)}))}(e)})),r("    removeSelfEdges",(function(){!function(e){n.forEach(e.edges(),(function(n){if(n.v===n.w){var r=e.node(n.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:n,label:e.edge(n)}),e.removeEdge(n)}}))}(e)})),r("    acyclic",(function(){C.run(e)})),r("    nestingGraph.run",(function(){de.run(e)})),r("    rank",(function(){oe(M.asNonCompoundGraph(e))})),r("    injectEdgeLabelProxies",(function(){!function(e){n.forEach(e.edges(),(function(n){var r=e.edge(n);if(r.width&&r.height){var t=e.node(n.v),o={rank:(e.node(n.w).rank-t.rank)/2+t.rank,e:n};M.addDummyNode(e,"edge-proxy",o,"_ep")}}))}(e)})),r("    removeEmptyRanks",(function(){P(e)})),r("    nestingGraph.cleanup",(function(){de.cleanup(e)})),r("    normalizeRanks",(function(){G(e)})),r("    assignRankMinMax",(function(){!function(e){var r=0;n.forEach(e.nodes(),(function(t){var o=e.node(t);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,r=n.max(r,o.maxRank))})),e.graph().maxRank=r}(e)})),r("    removeEdgeLabelProxies",(function(){!function(e){n.forEach(e.nodes(),(function(n){var r=e.node(n);"edge-proxy"===r.dummy&&(e.edge(r.e).labelRank=r.rank,e.removeNode(n))}))}(e)})),r("    normalize.run",(function(){j.run(e)})),r("    parentDummyChains",(function(){se(e)})),r("    addBorderSegments",(function(){!function(e){n.forEach(e.children(),(function r(t){var o=e.children(t),i=e.node(t);if(o.length&&n.forEach(o,r),n.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)ce(e,"borderLeft","_bl",t,i,a),ce(e,"borderRight","_br",t,i,a)}}))}(e)})),r("    order",(function(){Ne(e)})),r("    insertSelfEdges",(function(){!function(e){var r=M.buildLayerMatrix(e);n.forEach(r,(function(r){var t=0;n.forEach(r,(function(r,o){var i=e.node(r);i.order=o+t,n.forEach(i.selfEdges,(function(n){M.addDummyNode(e,"selfedge",{width:n.label.width,height:n.label.height,rank:i.rank,order:o+ ++t,e:n.e,label:n.label},"_se")})),delete i.selfEdges}))}))}(e)})),r("    adjustCoordinateSystem",(function(){le.adjust(e)})),r("    position",(function(){Ue(e)})),r("    positionSelfEdges",(function(){!function(e){n.forEach(e.nodes(),(function(n){var r=e.node(n);if("selfedge"===r.dummy){var t=e.node(r.e.v),o=t.x+t.width/2,i=t.y,a=r.x-o,s=t.height/2;e.setEdge(r.e,r.label),e.removeNode(n),r.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.label.x=r.x,r.label.y=r.y}}))}(e)})),r("    removeBorderNodes",(function(){!function(e){n.forEach(e.nodes(),(function(r){if(e.children(r).length){var t=e.node(r),o=e.node(t.borderTop),i=e.node(t.borderBottom),a=e.node(n.last(t.borderLeft)),s=e.node(n.last(t.borderRight));t.width=Math.abs(s.x-a.x),t.height=Math.abs(i.y-o.y),t.x=a.x+t.width/2,t.y=o.y+t.height/2}})),n.forEach(e.nodes(),(function(n){"border"===e.node(n).dummy&&e.removeNode(n)}))}(e)})),r("    normalize.undo",(function(){j.undo(e)})),r("    fixupEdgeLabelCoords",(function(){!function(e){n.forEach(e.edges(),(function(r){var t=e.edge(r);if(n.has(t,"x"))switch("l"!==t.labelpos&&"r"!==t.labelpos||(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset}}))}(e)})),r("    undoCoordinateSystem",(function(){le.undo(e)})),r("    translateGraph",(function(){!function(e){var r=Number.POSITIVE_INFINITY,t=0,o=Number.POSITIVE_INFINITY,i=0,a=e.graph(),s=a.marginx||0,u=a.marginy||0;function d(e){var n=e.x,a=e.y,s=e.width,u=e.height;r=Math.min(r,n-s/2),t=Math.max(t,n+s/2),o=Math.min(o,a-u/2),i=Math.max(i,a+u/2)}n.forEach(e.nodes(),(function(n){d(e.node(n))})),n.forEach(e.edges(),(function(r){var t=e.edge(r);n.has(t,"x")&&d(t)})),r-=s,o-=u,n.forEach(e.nodes(),(function(n){var t=e.node(n);t.x-=r,t.y-=o})),n.forEach(e.edges(),(function(t){var i=e.edge(t);n.forEach(i.points,(function(e){e.x-=r,e.y-=o})),n.has(i,"x")&&(i.x-=r),n.has(i,"y")&&(i.y-=o)})),a.width=t-r+s,a.height=i-o+u}(e)})),r("    assignNodeIntersects",(function(){!function(e){n.forEach(e.edges(),(function(n){var r,t,o=e.edge(n),i=e.node(n.v),a=e.node(n.w);o.points?(r=o.points[0],t=o.points[o.points.length-1]):(o.points=[],r=a,t=i),o.points.unshift(M.intersectRect(i,r)),o.points.push(M.intersectRect(a,t))}))}(e)})),r("    reversePoints",(function(){!function(e){n.forEach(e.edges(),(function(n){var r=e.edge(n);r.reversed&&r.points.reverse()}))}(e)})),r("    acyclic.undo",(function(){C.undo(e)}))}(r,t)})),t("  updateInputGraph",(function(){!function(e,r){n.forEach(e.nodes(),(function(n){var t=e.node(n),o=r.node(n);t&&(t.x=o.x,t.y=o.y,r.children(n).length&&(t.width=o.width,t.height=o.height))})),n.forEach(e.edges(),(function(t){var o=e.edge(t),i=r.edge(t);o.points=i.points,n.has(i,"x")&&(o.x=i.x,o.y=i.y)})),e.graph().width=r.graph().width,e.graph().height=r.graph().height}(e,r)}))}))},debug:$e,util:{time:D,notime:S}};return en}(lodash);
