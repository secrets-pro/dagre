"use strict";var e,n=require("lodash"),r=(e=n)&&"object"==typeof e&&"default"in e?e.default:e;class t{constructor(e={}){this._nodes={},this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={},this._nodeCount=0,this._edgeCount=0,this._isDirected=!n.has(e,"directed")||e.directed,this._isMultigraph=!!n.has(e,"multigraph")&&e.multigraph,this._isCompound=!!n.has(e,"compound")&&e.compound,this._isCompound&&(this._parent={},this._children={},this._children["\0"]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return n.keys(this._nodes)}sources(){var e=this;return n.filter(this.nodes(),(function(r){return n.isEmpty(e._in[r])}))}sinks(){var e=this;return n.filter(this.nodes(),(function(r){return n.isEmpty(e._out[r])}))}setNodes(e,r){var t=arguments,o=this;return n.each(e,(function(e){t.length>1?o.setNode(e,r):o.setNode(e)})),this}setNode(e,r){if(n.has(this._nodes,e))return arguments.length>1&&(this._nodes[e]=r),this;let t=this._defaultNodeLabelFn||function(e){return e};return this._nodes[e]=arguments.length>1?r:t(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this}node(e){return this._nodes[e]}hasNode(e){return n.has(this._nodes,e)}removeNode(e){var r=this;if(n.has(this._nodes,e)){var t=function(e){r.removeEdge(r._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],n.each(this.children(e),(function(e){r.setParent(e)})),delete this._children[e]),n.each(n.keys(this._in[e]),t),delete this._in[e],delete this._preds[e],n.each(n.keys(this._out[e]),t),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n.isUndefined(r))r="\0";else{for(var t=r+="";!n.isUndefined(t);t=this.parent(t))if(t===e)throw new Error("Setting "+r+" as parent of "+e+" would create a cycle");this.setNode(r)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=r,this._children[r][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var n=this._parent[e];if("\0"!==n)return n}}children(e){if(n.isUndefined(e)&&(e="\0"),this._isCompound){var r=this._children[e];if(r)return n.keys(r)}else{if("\0"===e)return this.nodes();if(this.hasNode(e))return[]}return[]}predecessors(e){var r=this._preds[e];return r?n.keys(r):[]}successors(e){var r=this._sucs[e];return r?n.keys(r):[]}neighbors(e){var r=this.predecessors(e);if(r)return n.union(r,this.successors(e))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var r=new t({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var o=this;n.each(this._nodes,(function(n,t){e(t)&&r.setNode(t,n)})),n.each(this._edgeObjs,(function(e){r.hasNode(e.v)&&r.hasNode(e.w)&&r.setEdge(e,o.edge(e))}));var i={};function a(e){var n=o.parent(e);return void 0===n||r.hasNode(n)?(i[e]=n,n):n in i?i[n]:a(n)}return this._isCompound&&n.each(r.nodes(),(function(e){r.setParent(e,a(e))})),r}setDefaultEdgeLabel(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return n.values(this._edgeObjs)}setPath(e,r){var t=this,o=arguments;return n.reduce(e,(function(e,n){return o.length>1?t.setEdge(e,n,r):t.setEdge(e,n),n})),this}setEdge(e,r,t,i){var s,u,d,c,h=!1,f=arguments[0];"object"==typeof f&&null!==f&&"v"in f?(s=f.v,u=f.w,d=f.name,2===arguments.length&&(c=arguments[1],h=!0)):(s=f,u=arguments[1],d=arguments[3],arguments.length>2&&(c=arguments[2],h=!0)),s=""+s,u=""+u,n.isUndefined(d)||(d=""+d);var g=a(this._isDirected,s,u,d);if(n.has(this._edgeLabels,g))return h&&(this._edgeLabels[g]=c),this;if(!n.isUndefined(d)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(s),this.setNode(u),this._edgeLabels[g]=h?c:this._defaultEdgeLabelFn(s,u,d);var v=function(e,n,r,t){var o=""+n,i=""+r;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};return t&&(s.name=t),s}(this._isDirected,s,u,d);return s=v.v,u=v.w,Object.freeze(v),this._edgeObjs[g]=v,o(this._preds[u],s),o(this._sucs[s],u),this._in[u][g]=v,this._out[s][g]=v,this._edgeCount++,this}edge(e,n,r){var t=1===arguments.length?s(this._isDirected,arguments[0]):a(this._isDirected,e,n,r);return this._edgeLabels[t]}hasEdge(e,r,t){var o=1===arguments.length?s(this._isDirected,arguments[0]):a(this._isDirected,e,r,t);return n.has(this._edgeLabels,o)}removeEdge(e,n,r){var t=1===arguments.length?s(this._isDirected,arguments[0]):a(this._isDirected,e,n,r),o=this._edgeObjs[t];if(o){const e=o.v,n=o.w;delete this._edgeLabels[t],delete this._edgeObjs[t],i(this._preds[n],e),i(this._sucs[e],n),delete this._in[n][t],delete this._out[e][t],this._edgeCount--}return this}inEdges(e,r){var t=this._in[e];if(t){var o=n.values(t);return r?n.filter(o,(function(e){return e.v===r})):o}}outEdges(e,r){var t=this._out[e];if(t){var o=n.values(t);return r?n.filter(o,(function(e){return e.w===r})):o}}nodeEdges(e,n){var r=this.inEdges(e,n);if(r)return r.concat(this.outEdges(e,n))}}function o(e,n){e[n]?e[n]++:e[n]=1}function i(e,n){--e[n]||delete e[n]}function a(e,r,t,o){var i=""+r,a=""+t;if(!e&&i>a){var s=i;i=a,a=s}return i+""+a+""+(n.isUndefined(o)?"\0":o)}function s(e,n){return a(e,n.v,n.w,n.name)}var u={Graph:t};class d{constructor(){this._arr=[],this._keyIndices={}}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return n.has(this._keyIndices,e)}priority(e){var n=this._keyIndices[e];if(void 0!==n)return this._arr[n].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,r){var t=this._keyIndices;if(e=String(e),!n.has(t,e)){var o=this._arr,i=o.length;return t[e]=i,o.push({key:e,priority:r}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,n){var r=this._keyIndices[e];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(e){var n=this._arr,r=2*e,t=r+1,o=e;r<n.length&&(o=n[r].priority<n[o].priority?r:o,t<n.length&&(o=n[t].priority<n[o].priority?t:o),o!==e&&(this._swap(e,o),this._heapify(o)))}_decrease(e){for(var n,r=this._arr,t=r[e].priority;0!==e&&!(r[n=e>>1].priority<t);)this._swap(e,n),e=n}_swap(e,n){var r=this._arr,t=this._keyIndices,o=r[e],i=r[n];r[e]=i,r[n]=o,t[i.key]=e,t[o.key]=n}}var c=n.constant(1);function h(e,n,r,t){return function(e,n,r,t){var o,i,a={},s=new d,u=function(e){var n=e.v!==o?e.v:e.w,t=a[n],u=r(e),d=i.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+u);d<t.distance&&(t.distance=d,t.predecessor=o,s.decrease(n,d))};for(e.nodes().forEach((function(e){var r=e===n?0:Number.POSITIVE_INFINITY;a[e]={distance:r},s.add(e,r)}));s.size()>0&&(o=s.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)t(o).forEach(u);return a}(e,String(n),r||c,t||function(n){return e.outEdges(n)})}function f(e){var r=0,t=[],o={},i=[];function a(s){var u=o[s]={onStack:!0,lowlink:r,index:r++};if(t.push(s),e.successors(s).forEach((function(e){n.has(o,e)?o[e].onStack&&(u.lowlink=Math.min(u.lowlink,o[e].index)):(a(e),u.lowlink=Math.min(u.lowlink,o[e].lowlink))})),u.lowlink===u.index){var d,c=[];do{d=t.pop(),o[d].onStack=!1,c.push(d)}while(s!==d);i.push(c)}}return e.nodes().forEach((function(e){n.has(o,e)||a(e)})),i}var g=n.constant(1);function v(e){var r={},t={},o=[];if(n.each(e.sinks(),(function i(a){if(n.has(t,a))throw new l;n.has(r,a)||(t[a]=!0,r[a]=!0,n.each(e.predecessors(a),i),delete t[a],o.push(a))})),n.size(r)!==e.nodeCount())throw new l;return o}function l(){}function p(e,r,t){n.isArray(r)||(r=[r]);var o=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return n.each(r,(function(n){if(!e.hasNode(n))throw new Error("Graph does not have node: "+n);m(e,n,"post"===t,a,o,i)})),i}function m(e,r,t,o,i,a){n.has(o,r)||(o[r]=!0,t||a.push(r),n.each(i(r),(function(n){m(e,n,t,o,i,a)})),t&&a.push(r))}function E(e){return n.map(e.nodes(),(function(r){var t=e.node(r),o=e.parent(r),i={v:r};return n.isUndefined(t)||(i.value=t),n.isUndefined(o)||(i.parent=o),i}))}function w(e){return n.map(e.edges(),(function(r){var t=e.edge(r),o={v:r.v,w:r.w};return n.isUndefined(r.name)||(o.name=r.name),n.isUndefined(t)||(o.value=t),o}))}v.CycleException=l,l.prototype=new Error;var y={Graph:u.Graph,json:{read:function(e){var r=new t(e.options).setGraph(e.value);return n.each(e.nodes,(function(e){r.setNode(e.v,e.value),e.parent&&r.setParent(e.v,e.parent)})),n.each(e.edges,(function(e){r.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),r},write:function(e){var r={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:E(e),edges:w(e)};return n.isUndefined(e.graph())||(r.value=n.clone(e.graph())),r}},alg:{components:function(e){var r,t={},o=[];function i(o){n.has(t,o)||(t[o]=!0,r.push(o),n.each(e.successors(o),i),n.each(e.predecessors(o),i))}return n.each(e.nodes(),(function(e){r=[],i(e),r.length&&o.push(r)})),o},dijkstra:h,dijkstraAll:function(e,r,t){return n.transform(e.nodes(),(function(n,o){n[o]=h(e,o,r,t)}),{})},findCycles:function(e){return n.filter(f(e),(function(n){return n.length>1||1===n.length&&e.hasEdge(n[0],n[0])}))},isAcyclic:function(e){try{v(e)}catch(e){if(e instanceof v.CycleException)return!1;throw e}return!0},floydWarshall:function(e,n,r){return function(e,n,r){var t={},o=e.nodes();return o.forEach((function(e){t[e]={},t[e][e]={distance:0},o.forEach((function(n){e!==n&&(t[e][n]={distance:Number.POSITIVE_INFINITY})})),r(e).forEach((function(r){var o=r.v===e?r.w:r.v,i=n(r);t[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var n=t[e];o.forEach((function(r){var i=t[r];o.forEach((function(r){var t=i[e],o=n[r],a=i[r],s=t.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),t}(e,n||g,r||function(n){return e.outEdges(n)})},postorder:function(e,n){return p(e,n,"post")},preorder:function(e,n){return p(e,n,"pre")},prim:function(e,r){var o,i=new t,a={},s=new d;function u(e){var n=e.v===o?e.w:e.v,t=s.priority(n);if(void 0!==t){var i=r(e);i<t&&(a[n]=o,s.decrease(n,i))}}if(0===e.nodeCount())return i;n.each(e.nodes(),(function(e){s.add(e,Number.POSITIVE_INFINITY),i.setNode(e)})),s.decrease(e.nodes()[0],0);for(var c=!1;s.size()>0;){if(o=s.removeMin(),n.has(a,o))i.setEdge(o,a[o]);else{if(c)throw new Error("Input graph is not connected: "+e);c=!0}e.nodeEdges(o).forEach(u)}return i},tarjan:f,topsort:v},version:u.version};function _(){var e={};e._next=e._prev=e,this._sentinel=e}function b(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function k(e,n){if("_next"!==e&&"_prev"!==e)return n}_.prototype.dequeue=function(){var e=this._sentinel,n=e._prev;if(n!==e)return b(n),n},_.prototype.enqueue=function(e){var n=this._sentinel;e._prev&&e._next&&b(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n},_.prototype.toString=function(){for(var e=[],n=this._sentinel,r=n._prev;r!==n;)e.push(JSON.stringify(r,k)),r=r._prev;return"["+e.join(", ")+"]"};var N=y.Graph;function x(e,n){if(e.nodeCount()<=1)return[];var t=function(e,n){var t=new N,o=0,i=0;r.forEach(e.nodes(),(function(e){t.setNode(e,{v:e,in:0,out:0})})),r.forEach(e.edges(),(function(e){var r=t.edge(e.v,e.w)||0,a=n(e),s=r+a;t.setEdge(e.v,e.w,s),i=Math.max(i,t.node(e.v).out+=a),o=Math.max(o,t.node(e.w).in+=a)}));var a=r.range(i+o+3).map((function(){return new _})),s=o+1;return r.forEach(t.nodes(),(function(e){C(a,s,t.node(e))})),{graph:t,buckets:a,zeroIdx:s}}(e,n||1),o=function(e,n,r){var t,o=[],i=n[n.length-1],a=n[0];for(;e.nodeCount();){for(;t=a.dequeue();)I(e,n,r,t);for(;t=i.dequeue();)I(e,n,r,t);if(e.nodeCount())for(var s=n.length-2;s>0;--s)if(t=n[s].dequeue()){o=o.concat(I(e,n,r,t,!0));break}}return o}(t.graph,t.buckets,t.zeroIdx);return r.flatten(r.map(o,(function(n){return e.outEdges(n.v,n.w)})),!0)}function I(e,n,t,o,i){var a=i?[]:void 0;return r.forEach(e.inEdges(o.v),(function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,C(n,t,s)})),r.forEach(e.outEdges(o.v),(function(r){var o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,C(n,t,a)})),e.removeNode(o.v),a}function C(e,n,r){r.out?r.in?e[r.out-r.in+n].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var L={run:function(e){var n="greedy"===e.graph().acyclicer?x(e,function(e){return function(n){return e.edge(n).weight}}(e)):function(e){var n=[],t={},o={};function i(a){r.has(o,a)||(o[a]=!0,t[a]=!0,r.forEach(e.outEdges(a),(function(e){r.has(t,e.w)?n.push(e):i(e.w)})),delete t[a])}return r.forEach(e.nodes(),i),n}(e);r.forEach(n,(function(n){var t=e.edge(n);e.removeEdge(n),t.forwardName=n.name,t.reversed=!0,e.setEdge(n.w,n.v,t,r.uniqueId("rev"))}))},undo:function(e){r.forEach(e.edges(),(function(n){var r=e.edge(n);if(r.reversed){e.removeEdge(n);var t=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(n.w,n.v,r,t)}}))}},M=y.Graph,R={addDummyNode:T,simplify:G,asNonCompoundGraph:function(e){var n=new M({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),(function(r){e.children(r).length||n.setNode(r,e.node(r))})),r.forEach(e.edges(),(function(r){n.setEdge(r,e.edge(r))})),n},successorWeights:function(e){var n=r.map(e.nodes(),(function(n){var t={};return r.forEach(e.outEdges(n),(function(n){t[n.w]=(t[n.w]||0)+e.edge(n).weight})),t}));return r.zipObject(e.nodes(),n)},predecessorWeights:function(e){var n=r.map(e.nodes(),(function(n){var t={};return r.forEach(e.inEdges(n),(function(n){t[n.v]=(t[n.v]||0)+e.edge(n).weight})),t}));return r.zipObject(e.nodes(),n)},intersectRect:function(e,n){var r,t,o=e.x,i=e.y,a=n.x-o,s=n.y-i,u=e.width/2,d=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,t=d):(a<0&&(u=-u),r=u,t=u*s/a);return{x:o+r,y:i+t}},buildLayerMatrix:function(e){var n=r.map(r.range(j(e)+1),(function(){return[]}));return r.forEach(e.nodes(),(function(t){var o=e.node(t),i=o.rank;r.isUndefined(i)||(n[i][o.order]=t)})),n},normalizeRanks:P,removeEmptyRanks:O,addBorderNode:function(e,n,r,t){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=t);return T(e,"border",o,n)},maxRank:j,partition:function(e,n){var t={lhs:[],rhs:[]};return r.forEach(e,(function(e){n(e)?t.lhs.push(e):t.rhs.push(e)})),t},time:D,notime:S};function T(e,n,t,o){var i;do{i=r.uniqueId(o)}while(e.hasNode(i));return t.dummy=n,e.setNode(i,t),i}function G(e){var n=(new M).setGraph(e.graph());return r.forEach(e.nodes(),(function(r){n.setNode(r,e.node(r))})),r.forEach(e.edges(),(function(r){var t=n.edge(r.v,r.w)||{weight:0,minlen:1},o=e.edge(r);n.setEdge(r.v,r.w,{weight:t.weight+o.weight,minlen:Math.max(t.minlen,o.minlen)})})),n}function P(e){var n=r.min(r.map(e.nodes(),(function(n){return e.node(n).rank})));r.forEach(e.nodes(),(function(t){var o=e.node(t);r.has(o,"rank")&&(o.rank-=n)}))}function O(e){var n=r.min(r.map(e.nodes(),(function(n){return e.node(n).rank}))),t=[];r.forEach(e.nodes(),(function(r){var o=e.node(r).rank-n;t[o]||(t[o]=[]),t[o].push(r)}));var o=0,i=e.graph().nodeRankFactor;r.forEach(t,(function(n,t){r.isUndefined(n)&&t%i!=0?--o:o&&r.forEach(n,(function(n){e.node(n).rank+=o}))}))}function j(e){return r.max(r.map(e.nodes(),(function(n){var t=e.node(n).rank;if(!r.isUndefined(t))return t})))}function D(e,n){var t=r.now();try{return n()}finally{console.log(e+" time: "+(r.now()-t)+"ms")}}function S(e,n){return n()}var F={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),(function(n){!function(e,n){var r,t,o,i=n.v,a=e.node(i).rank,s=n.w,u=e.node(s).rank,d=n.name,c=e.edge(n),h=c.labelRank;if(u===a+1)return;for(e.removeEdge(n),o=0,++a;a<u;++o,++a)c.points=[],t={width:0,height:0,edgeLabel:c,edgeObj:n,rank:a},r=R.addDummyNode(e,"edge",t,"_d"),a===h&&(t.width=c.width,t.height=c.height,t.dummy="edge-label",t.labelpos=c.labelpos),e.setEdge(i,r,{weight:c.weight},d),0===o&&e.graph().dummyChains.push(r),i=r;e.setEdge(i,s,{weight:c.weight},d)}(e,n)}))},undo:function(e){r.forEach(e.graph().dummyChains,(function(n){var r,t=e.node(n),o=t.edgeLabel;for(e.setEdge(t.edgeObj,o);t.dummy;)r=e.successors(n)[0],e.removeNode(n),o.points.push({x:t.x,y:t.y}),"edge-label"===t.dummy&&(o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height),n=r,t=e.node(n)}))}};function B(e){var n={};r.forEach(e.sources(),(function t(o){var i=e.node(o);if(r.has(n,o))return i.rank;n[o]=!0;var a=r.min(r.map(e.outEdges(o),(function(n){return t(n.w)-e.edge(n).minlen})));return a!==Number.POSITIVE_INFINITY&&null!=a||(a=0),i.rank=a}))}function U(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen}var V=B,z=y.Graph;function q(e){var n,r,t=new z({directed:!1}),o=e.nodes()[0],i=e.nodeCount();for(t.setNode(o,{});Y(t,e)<i;)n=A(t,e),r=t.hasNode(n.v)?U(e,n):-U(e,n),W(t,e,r);return t}function Y(e,n){return r.forEach(e.nodes(),(function t(o){r.forEach(n.nodeEdges(o),(function(r){var i=r.v,a=o===i?r.w:i;e.hasNode(a)||U(n,r)||(e.setNode(a,{}),e.setEdge(o,a,{}),t(a))}))})),e.nodeCount()}function A(e,n){return r.minBy(n.edges(),(function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return U(n,r)}))}function W(e,n,t){r.forEach(e.nodes(),(function(e){n.node(e).rank+=t}))}var J=y.alg.preorder,K=y.alg.postorder;function Q(e){B(e=G(e));var n,r=q(e);for(Z(r),H(r,e);n=ee(r);)re(r,e,n,ne(r,e,n))}function H(e,n){var t=K(e,e.nodes());t=t.slice(0,t.length-1),r.forEach(t,(function(r){!function(e,n,r){var t=e.node(r).parent;e.edge(r,t).cutvalue=X(e,n,r)}(e,n,r)}))}function X(e,n,t){var o=e.node(t).parent,i=!0,a=n.edge(t,o),s=0;return a||(i=!1,a=n.edge(o,t)),s=a.weight,r.forEach(n.nodeEdges(t),(function(r){var a=r.v===t,u=a?r.w:r.v;if(u!==o){var d=a===i,c=n.edge(r).weight;if(s+=d?c:-c,function(e,n,r){return e.hasEdge(n,r)}(e,t,u)){var h=e.edge(t,u).cutvalue;s+=d?-h:h}}})),s}function Z(e,n){arguments.length<2&&(n=e.nodes()[0]),$(e,{},1,n)}function $(e,n,t,o,i){var a=t,s=e.node(o);return n[o]=!0,r.forEach(e.neighbors(o),(function(i){r.has(n,i)||(t=$(e,n,t,i,o))})),s.low=a,s.lim=t++,i?s.parent=i:delete s.parent,t}function ee(e){return r.find(e.edges(),(function(n){return e.edge(n).cutvalue<0}))}function ne(e,n,t){var o=t.v,i=t.w;n.hasEdge(o,i)||(o=t.w,i=t.v);var a=e.node(o),s=e.node(i),u=a,d=!1;a.lim>s.lim&&(u=s,d=!0);var c=r.filter(n.edges(),(function(n){return d===te(e,e.node(n.v),u)&&d!==te(e,e.node(n.w),u)}));return r.minBy(c,(function(e){return U(n,e)}))}function re(e,n,t,o){var i=t.v,a=t.w;e.removeEdge(i,a),e.setEdge(o.v,o.w,{}),Z(e),H(e,n),function(e,n){var t=r.find(e.nodes(),(function(e){return!n.node(e).parent})),o=J(e,t);o=o.slice(1),r.forEach(o,(function(r){var t=e.node(r).parent,o=n.edge(r,t),i=!1;o||(o=n.edge(t,r),i=!0),n.node(r).rank=n.node(t).rank+(i?o.minlen:-o.minlen)}))}(e,n)}function te(e,n,r){return r.low<=n.lim&&n.lim<=r.lim}Q.initLowLimValues=Z,Q.initCutValues=H,Q.calcCutValue=X,Q.leaveEdge=ee,Q.enterEdge=ne,Q.exchangeEdges=re;var oe=V;function ie(e){switch(e.graph().ranker){case"network-simplex":default:se(e);break;case"tight-tree":!function(e){oe(e),q(e)}(e);break;case"longest-path":ae(e)}}var ae=oe;function se(e){Q(e)}function ue(e){var n=function(e){var n={},t=0;function o(i){var a=t;r.forEach(e.children(i),o),n[i]={low:a,lim:t++}}return r.forEach(e.children(),o),n}(e);r.forEach(e.graph().dummyChains,(function(r){for(var t=e.node(r),o=t.edgeObj,i=function(e,n,r,t){var o,i,a=[],s=[],u=Math.min(n[r].low,n[t].low),d=Math.max(n[r].lim,n[t].lim);o=r;do{o=e.parent(o),a.push(o)}while(o&&(n[o].low>u||d>n[o].lim));i=o,o=t;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,n,o.v,o.w),a=i.path,s=i.lca,u=0,d=a[u],c=!0;r!==o.w;){if(t=e.node(r),c){for(;(d=a[u])!==s&&e.node(d).maxRank<t.rank;)u++;d===s&&(c=!1)}if(!c){for(;u<a.length-1&&e.node(d=a[u+1]).minRank<=t.rank;)u++;d=a[u]}e.setParent(r,d),r=e.successors(r)[0]}}))}function de(e,n,t,o,i,a,s){var u=e.children(s);if(u.length){var d=R.addBorderNode(e,"_bt"),c=R.addBorderNode(e,"_bb"),h=e.node(s);e.setParent(d,s),h.borderTop=d,e.setParent(c,s),h.borderBottom=c,r.forEach(u,(function(r){de(e,n,t,o,i,a,r);var u=e.node(r),h=u.borderTop?u.borderTop:r,f=u.borderBottom?u.borderBottom:r,g=u.borderTop?o:2*o,v=h!==f?1:i-a[s]+1;e.setEdge(d,h,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(f,c,{weight:g,minlen:v,nestingEdge:!0})})),e.parent(s)||e.setEdge(n,d,{weight:0,minlen:i+a[s]})}else s!==n&&e.setEdge(n,s,{weight:0,minlen:t})}var ce={run:function(e){var n=R.addDummyNode(e,"root",{},"_root"),t=function(e){var n={};function t(o,i){var a=e.children(o);a&&a.length&&r.forEach(a,(function(e){t(e,i+1)})),n[o]=i}return r.forEach(e.children(),(function(e){t(e,1)})),n}(e),o=r.max(r.values(t))-1,i=2*o+1;e.graph().nestingRoot=n,r.forEach(e.edges(),(function(n){e.edge(n).minlen*=i}));var a=function(e){return r.reduce(e.edges(),(function(n,r){return n+e.edge(r).weight}),0)}(e)+1;r.forEach(e.children(),(function(r){de(e,n,i,a,o,t,r)})),e.graph().nodeRankFactor=i},cleanup:function(e){var n=e.graph();e.removeNode(n.nestingRoot),delete n.nestingRoot,r.forEach(e.edges(),(function(n){e.edge(n).nestingEdge&&e.removeEdge(n)}))}};function he(e,n,r,t,o,i){var a={width:0,height:0,rank:i,borderType:n},s=o[n][i-1],u=R.addDummyNode(e,"border",a,r);o[n][i]=u,e.setParent(u,t),s&&e.setEdge(s,u,{weight:1})}function fe(e){r.forEach(e.nodes(),(function(n){ge(e.node(n))})),r.forEach(e.edges(),(function(n){ge(e.edge(n))}))}function ge(e){var n=e.width;e.width=e.height,e.height=n}function ve(e){e.y=-e.y}function le(e){var n=e.x;e.x=e.y,e.y=n}var pe={adjust:function(e){var n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||fe(e)},undo:function(e){var n=e.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||function(e){r.forEach(e.nodes(),(function(n){ve(e.node(n))})),r.forEach(e.edges(),(function(n){var t=e.edge(n);r.forEach(t.points,ve),r.has(t,"y")&&ve(t)}))}(e),"lr"!==n&&"rl"!==n||(!function(e){r.forEach(e.nodes(),(function(n){le(e.node(n))})),r.forEach(e.edges(),(function(n){var t=e.edge(n);r.forEach(t.points,le),r.has(t,"x")&&le(t)}))}(e),fe(e))}};function me(e,n){for(var r=0,t=1;t<n.length;++t)r+=Ee(e,n[t-1],n[t]);return r}function Ee(e,n,t){for(var o=r.zipObject(t,r.map(t,(function(e,n){return n}))),i=r.flatten(r.map(n,(function(n){return r.sortBy(r.map(e.outEdges(n),(function(n){return{pos:o[n.w],weight:e.edge(n).weight}})),"pos")})),!0),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var u=r.map(new Array(s),(function(){return 0})),d=0;return r.forEach(i.forEach((function(e){var n=e.pos+a;u[n]+=e.weight;for(var r=0;n>0;)n%2&&(r+=u[n+1]),u[n=n-1>>1]+=e.weight;d+=e.weight*r}))),d}function we(e,n){var t={};return r.forEach(e,(function(e,n){var o=t[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:n};r.isUndefined(e.barycenter)||(o.barycenter=e.barycenter,o.weight=e.weight)})),r.forEach(n.edges(),(function(e){var n=t[e.v],o=t[e.w];r.isUndefined(n)||r.isUndefined(o)||(o.indegree++,n.out.push(t[e.w]))})),function(e){var n=[];function t(e){return function(n){n.merged||(r.isUndefined(n.barycenter)||r.isUndefined(e.barycenter)||n.barycenter>=e.barycenter)&&function(e,n){var r=0,t=0;e.weight&&(r+=e.barycenter*e.weight,t+=e.weight);n.weight&&(r+=n.barycenter*n.weight,t+=n.weight);e.vs=n.vs.concat(e.vs),e.barycenter=r/t,e.weight=t,e.i=Math.min(n.i,e.i),n.merged=!0}(e,n)}}function o(n){return function(r){r.in.push(n),0==--r.indegree&&e.push(r)}}for(;e.length;){var i=e.pop();n.push(i),r.forEach(i.in.reverse(),t(i)),r.forEach(i.out,o(i))}return r.map(r.filter(n,(function(e){return!e.merged})),(function(e){return r.pick(e,["vs","i","barycenter","weight"])}))}(r.filter(t,(function(e){return!e.indegree})))}function ye(e,n,t){for(var o;n.length&&(o=r.last(n)).i<=t;)n.pop(),e.push(o.vs),t++;return t}function _e(e,n,t,o){var i=e.children(n),a=e.node(n),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,d={};s&&(i=r.filter(i,(function(e){return e!==s&&e!==u})));var c=function(e,n){return r.map(n,(function(n){var t=e.inEdges(n);if(t.length){var o=r.reduce(t,(function(n,r){var t=e.edge(r),o=e.node(r.v);return{sum:n.sum+t.weight*o.order,weight:n.weight+t.weight}}),{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}return{v:n}}))}(e,i);r.forEach(c,(function(n){if(e.children(n.v).length){var i=_e(e,n.v,t,o);d[n.v]=i,r.has(i,"barycenter")&&(a=n,s=i,r.isUndefined(a.barycenter)?(a.barycenter=s.barycenter,a.weight=s.weight):(a.barycenter=(a.barycenter*a.weight+s.barycenter*s.weight)/(a.weight+s.weight),a.weight+=s.weight))}var a,s}));var h=we(c,t);!function(e,n){r.forEach(e,(function(e){e.vs=r.flatten(e.vs.map((function(e){return n[e]?n[e].vs:e})),!0)}))}(h,d);var f=function(e,n){var t,o=R.partition(e,(function(e){return r.has(e,"barycenter")})),i=o.lhs,a=r.sortBy(o.rhs,(function(e){return-e.i})),s=[],u=0,d=0,c=0;i.sort((t=!!n,function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i})),c=ye(s,a,c),r.forEach(i,(function(e){c+=e.vs.length,s.push(e.vs),u+=e.barycenter*e.weight,d+=e.weight,c=ye(s,a,c)}));var h={vs:r.flatten(s,!0)};return d&&(h.barycenter=u/d,h.weight=d),h}(h,o);if(s&&(f.vs=r.flatten([s,f.vs,u],!0),e.predecessors(s).length)){var g=e.node(e.predecessors(s)[0]),v=e.node(e.predecessors(u)[0]);r.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+g.order+v.order)/(f.weight+2),f.weight+=2}return f}var be=y.Graph;function ke(e,n,t){var o=function(e){var n;for(;e.hasNode(n=r.uniqueId("_root")););return n}(e),i=new be({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(n){return e.node(n)}));return r.forEach(e.nodes(),(function(a){var s=e.node(a),u=e.parent(a);(s.rank===n||s.minRank<=n&&n<=s.maxRank)&&(i.setNode(a),i.setParent(a,u||o),r.forEach(e[t](a),(function(n){var t=n.v===a?n.w:n.v,o=i.edge(t,a),s=r.isUndefined(o)?0:o.weight;i.setEdge(t,a,{weight:e.edge(n).weight+s})})),r.has(s,"minRank")&&i.setNode(a,{borderLeft:s.borderLeft[n],borderRight:s.borderRight[n]}))})),i}var Ne=y.Graph;function xe(e){var n=R.maxRank(e),t=Ie(e,r.range(1,n+1),"inEdges"),o=Ie(e,r.range(n-1,-1,-1),"outEdges"),i=function(e){var n={},t=r.filter(e.nodes(),(function(n){return!e.children(n).length})),o=r.max(r.map(t,(function(n){return e.node(n).rank}))),i=r.map(r.range(o+1),(function(){return[]})),a=r.sortBy(t,(function(n){return e.node(n).rank}));return r.forEach(a,(function t(o){if(!r.has(n,o)){n[o]=!0;var a=e.node(o);i[a.rank].push(o),r.forEach(e.successors(o),t)}})),i}(e);Le(e,i);for(var a,s=Number.POSITIVE_INFINITY,u=0,d=0;d<4;++u,++d){Ce(u%2?t:o,u%4>=2);var c=me(e,i=R.buildLayerMatrix(e));c<s&&(d=0,a=r.cloneDeep(i),s=c)}Le(e,a)}function Ie(e,n,t){return r.map(n,(function(n){return ke(e,n,t)}))}function Ce(e,n){var t=new Ne;r.forEach(e,(function(e){var o=e.graph().root,i=_e(e,o,t,n);r.forEach(i.vs,(function(n,r){e.node(n).order=r})),function(e,n,t){var o,i={};r.forEach(t,(function(r){for(var t,a,s=e.parent(r);s;){if((t=e.parent(s))?(a=i[t],i[t]=s):(a=o,o=s),a&&a!==s)return void n.setEdge(a,s);s=t}}))}(e,t,i.vs)}))}function Le(e,n){r.forEach(n,(function(n){r.forEach(n,(function(n,r){e.node(n).order=r}))}))}var Me=y.Graph,Re=function(e){var n,t=R.buildLayerMatrix(e),o=r.merge(Te(e,t),Ge(e,t)),i={};r.forEach(["u","d"],(function(a){n="u"===a?t:r.values(t).reverse(),r.forEach(["l","r"],(function(t){"r"===t&&(n=r.map(n,(function(e){return r.values(e).reverse()})));var s=("u"===a?e.predecessors:e.successors).bind(e),u=je(e,n,o,s),d=De(e,n,u.root,u.align,"r"===t);"r"===t&&(d=r.mapValues(d,(function(e){return-e}))),i[a+t]=d}))}));var a=Se(e,i);return Fe(i,a),Be(i,e.graph().align)};function Te(e,n){var t={};return r.reduce(n,(function(n,o){var i=0,a=0,s=n.length,u=r.last(o);return r.forEach(o,(function(n,d){var c=function(e,n){if(e.node(n).dummy)return r.find(e.predecessors(n),(function(n){return e.node(n).dummy}))}(e,n),h=c?e.node(c).order:s;(c||n===u)&&(r.forEach(o.slice(a,d+1),(function(n){r.forEach(e.predecessors(n),(function(r){var o=e.node(r),a=o.order;!(a<i||h<a)||o.dummy&&e.node(n).dummy||Pe(t,r,n)}))})),a=d+1,i=h)})),o})),t}function Ge(e,n){var t={};function o(n,o,i,a,s){var u;r.forEach(r.range(o,i),(function(o){u=n[o],e.node(u).dummy&&r.forEach(e.predecessors(u),(function(n){var r=e.node(n);r.dummy&&(r.order<a||r.order>s)&&Pe(t,n,u)}))}))}return r.reduce(n,(function(n,t){var i,a=-1,s=0;return r.forEach(t,(function(r,u){if("border"===e.node(r).dummy){var d=e.predecessors(r);d.length&&(i=e.node(d[0]).order,o(t,s,u,a,i),s=u,a=i)}o(t,s,t.length,i,n.length)})),t})),t}function Pe(e,n,r){if(n>r){var t=n;n=r,r=t}var o=e[n];o||(e[n]=o={}),o[r]=!0}function Oe(e,n,t){if(n>t){var o=n;n=t,t=o}return r.has(e[n],t)}function je(e,n,t,o){var i={},a={},s={};return r.forEach(n,(function(e){r.forEach(e,(function(e,n){i[e]=e,a[e]=e,s[e]=n}))})),r.forEach(n,(function(e){var n=-1;r.forEach(e,(function(e){var u=o(e);if(u.length){u=r.sortBy(u,(function(e){return s[e]}));for(var d=(u.length-1)/2,c=Math.floor(d),h=Math.ceil(d);c<=h;++c){var f=u[c];a[e]===e&&n<s[f]&&!Oe(t,e,f)&&(a[f]=e,a[e]=i[e]=i[f],n=s[f])}}}))})),{root:i,align:a}}function De(e,n,t,o,i){var a={},s=function(e,n,t,o){var i=new Me,a=e.graph(),s=function(e,n,t){return function(o,i,a){var s,u=o.node(i),d=o.node(a),c=0;if(c+=u.width/2,r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=-u.width/2;break;case"r":s=u.width/2}if(s&&(c+=t?s:-s),s=0,c+=(u.dummy?n:e)/2,c+=(d.dummy?n:e)/2,c+=d.width/2,r.has(d,"labelpos"))switch(d.labelpos.toLowerCase()){case"l":s=d.width/2;break;case"r":s=-d.width/2}return s&&(c+=t?s:-s),s=0,c}}(a.nodesep,a.edgesep,o);return r.forEach(n,(function(n){var o;r.forEach(n,(function(n){var r=t[n];if(i.setNode(r),o){var a=t[o],u=i.edge(a,r);i.setEdge(a,r,Math.max(s(e,n,o),u||0))}o=n}))})),i}(e,n,t,i),u=i?"borderLeft":"borderRight";function d(e,n){for(var r=s.nodes(),t=r.pop(),o={};t;)o[t]?e(t):(o[t]=!0,r.push(t),r=r.concat(n(t))),t=r.pop()}return d((function(e){a[e]=s.inEdges(e).reduce((function(e,n){return Math.max(e,a[n.v]+s.edge(n))}),0)}),s.predecessors.bind(s)),d((function(n){var r=s.outEdges(n).reduce((function(e,n){return Math.min(e,a[n.w]-s.edge(n))}),Number.POSITIVE_INFINITY),t=e.node(n);r!==Number.POSITIVE_INFINITY&&t.borderType!==u&&(a[n]=Math.max(a[n],r))}),s.successors.bind(s)),r.forEach(o,(function(e){a[e]=a[t[e]]})),a}function Se(e,n){return r.minBy(r.values(n),(function(n){var t=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return r.forIn(n,(function(n,r){var i=function(e,n){return e.node(n).width}(e,r)/2;t=Math.max(n+i,t),o=Math.min(n-i,o)})),t-o}))}function Fe(e,n){var t=r.values(n),o=r.min(t),i=r.max(t);r.forEach(["u","d"],(function(t){r.forEach(["l","r"],(function(a){var s,u=t+a,d=e[u];if(d!==n){var c=r.values(d);(s="l"===a?o-r.min(c):i-r.max(c))&&(e[u]=r.mapValues(d,(function(e){return e+s})))}}))}))}function Be(e,n){return r.mapValues(e.ul,(function(t,o){if(n)return e[n.toLowerCase()][o];var i=r.sortBy(r.map(e,o));return(i[1]+i[2])/2}))}var Ue=Re;function Ve(e){(function(e){var n=R.buildLayerMatrix(e),t=e.graph().ranksep,o=0;r.forEach(n,(function(n){var i=r.max(r.map(n,(function(n){return e.node(n).height})));r.forEach(n,(function(n){e.node(n).y=o+i/2})),o+=i+t}))})(e=R.asNonCompoundGraph(e)),r.forEach(Ue(e),(function(n,r){e.node(r).x=n}))}var ze=y.Graph;var qe=["nodesep","edgesep","ranksep","marginx","marginy"],Ye={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Ae=["acyclicer","ranker","rankdir","align"],We=["width","height"],Je={width:0,height:0},Ke=["minlen","weight","width","height","labeloffset"],Qe={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},He=["labelpos"];function Xe(e,n){return r.mapValues(r.pick(e,n),Number)}function Ze(e){var n={};return r.forEach(e,(function(e,r){n[r.toLowerCase()]=e})),n}var $e=y.Graph;var en={debugOrdering:function(e){var n=R.buildLayerMatrix(e),t=new $e({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),(function(n){t.setNode(n,{label:n}),t.setParent(n,"layer"+e.node(n).rank)})),r.forEach(e.edges(),(function(e){t.setEdge(e.v,e.w,{},e.name)})),r.forEach(n,(function(e,n){var o="layer"+n;t.setNode(o,{rank:"same"}),r.reduce(e,(function(e,n){return t.setEdge(e,n,{style:"invis"}),n}))})),t}},nn={graphlib:y,layout:function(e,n){var t=n&&n.debugTiming?R.time:R.notime;t("layout",(function(){var n=t("  buildLayoutGraph",(function(){return function(e){var n=new ze({multigraph:!0,compound:!0}),t=Ze(e.graph());return n.setGraph(r.merge({},Ye,Xe(t,qe),r.pick(t,Ae))),r.forEach(e.nodes(),(function(t){var o=Ze(e.node(t));n.setNode(t,r.defaults(Xe(o,We),Je)),n.setParent(t,e.parent(t))})),r.forEach(e.edges(),(function(t){var o=Ze(e.edge(t));n.setEdge(t,r.merge({},Qe,Xe(o,Ke),r.pick(o,He)))})),n}(e)}));t("  runLayout",(function(){!function(e,n){n("    makeSpaceForEdgeLabels",(function(){!function(e){var n=e.graph();n.ranksep/=2,r.forEach(e.edges(),(function(r){var t=e.edge(r);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)}))}(e)})),n("    removeSelfEdges",(function(){!function(e){r.forEach(e.edges(),(function(n){if(n.v===n.w){var r=e.node(n.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:n,label:e.edge(n)}),e.removeEdge(n)}}))}(e)})),n("    acyclic",(function(){L.run(e)})),n("    nestingGraph.run",(function(){ce.run(e)})),n("    rank",(function(){ie(R.asNonCompoundGraph(e))})),n("    injectEdgeLabelProxies",(function(){!function(e){r.forEach(e.edges(),(function(n){var r=e.edge(n);if(r.width&&r.height){var t=e.node(n.v),o={rank:(e.node(n.w).rank-t.rank)/2+t.rank,e:n};R.addDummyNode(e,"edge-proxy",o,"_ep")}}))}(e)})),n("    removeEmptyRanks",(function(){O(e)})),n("    nestingGraph.cleanup",(function(){ce.cleanup(e)})),n("    normalizeRanks",(function(){P(e)})),n("    assignRankMinMax",(function(){!function(e){var n=0;r.forEach(e.nodes(),(function(t){var o=e.node(t);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,n=r.max(n,o.maxRank))})),e.graph().maxRank=n}(e)})),n("    removeEdgeLabelProxies",(function(){!function(e){r.forEach(e.nodes(),(function(n){var r=e.node(n);"edge-proxy"===r.dummy&&(e.edge(r.e).labelRank=r.rank,e.removeNode(n))}))}(e)})),n("    normalize.run",(function(){F.run(e)})),n("    parentDummyChains",(function(){ue(e)})),n("    addBorderSegments",(function(){!function(e){r.forEach(e.children(),(function n(t){var o=e.children(t),i=e.node(t);if(o.length&&r.forEach(o,n),r.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)he(e,"borderLeft","_bl",t,i,a),he(e,"borderRight","_br",t,i,a)}}))}(e)})),n("    order",(function(){xe(e)})),n("    insertSelfEdges",(function(){!function(e){var n=R.buildLayerMatrix(e);r.forEach(n,(function(n){var t=0;r.forEach(n,(function(n,o){var i=e.node(n);i.order=o+t,r.forEach(i.selfEdges,(function(n){R.addDummyNode(e,"selfedge",{width:n.label.width,height:n.label.height,rank:i.rank,order:o+ ++t,e:n.e,label:n.label},"_se")})),delete i.selfEdges}))}))}(e)})),n("    adjustCoordinateSystem",(function(){pe.adjust(e)})),n("    position",(function(){Ve(e)})),n("    positionSelfEdges",(function(){!function(e){r.forEach(e.nodes(),(function(n){var r=e.node(n);if("selfedge"===r.dummy){var t=e.node(r.e.v),o=t.x+t.width/2,i=t.y,a=r.x-o,s=t.height/2;e.setEdge(r.e,r.label),e.removeNode(n),r.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.label.x=r.x,r.label.y=r.y}}))}(e)})),n("    removeBorderNodes",(function(){!function(e){r.forEach(e.nodes(),(function(n){if(e.children(n).length){var t=e.node(n),o=e.node(t.borderTop),i=e.node(t.borderBottom),a=e.node(r.last(t.borderLeft)),s=e.node(r.last(t.borderRight));t.width=Math.abs(s.x-a.x),t.height=Math.abs(i.y-o.y),t.x=a.x+t.width/2,t.y=o.y+t.height/2}})),r.forEach(e.nodes(),(function(n){"border"===e.node(n).dummy&&e.removeNode(n)}))}(e)})),n("    normalize.undo",(function(){F.undo(e)})),n("    fixupEdgeLabelCoords",(function(){!function(e){r.forEach(e.edges(),(function(n){var t=e.edge(n);if(r.has(t,"x"))switch("l"!==t.labelpos&&"r"!==t.labelpos||(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset}}))}(e)})),n("    undoCoordinateSystem",(function(){pe.undo(e)})),n("    translateGraph",(function(){!function(e){var n=Number.POSITIVE_INFINITY,t=0,o=Number.POSITIVE_INFINITY,i=0,a=e.graph(),s=a.marginx||0,u=a.marginy||0;function d(e){var r=e.x,a=e.y,s=e.width,u=e.height;n=Math.min(n,r-s/2),t=Math.max(t,r+s/2),o=Math.min(o,a-u/2),i=Math.max(i,a+u/2)}r.forEach(e.nodes(),(function(n){d(e.node(n))})),r.forEach(e.edges(),(function(n){var t=e.edge(n);r.has(t,"x")&&d(t)})),n-=s,o-=u,r.forEach(e.nodes(),(function(r){var t=e.node(r);t.x-=n,t.y-=o})),r.forEach(e.edges(),(function(t){var i=e.edge(t);r.forEach(i.points,(function(e){e.x-=n,e.y-=o})),r.has(i,"x")&&(i.x-=n),r.has(i,"y")&&(i.y-=o)})),a.width=t-n+s,a.height=i-o+u}(e)})),n("    assignNodeIntersects",(function(){!function(e){r.forEach(e.edges(),(function(n){var r,t,o=e.edge(n),i=e.node(n.v),a=e.node(n.w);o.points?(r=o.points[0],t=o.points[o.points.length-1]):(o.points=[],r=a,t=i),o.points.unshift(R.intersectRect(i,r)),o.points.push(R.intersectRect(a,t))}))}(e)})),n("    reversePoints",(function(){!function(e){r.forEach(e.edges(),(function(n){var r=e.edge(n);r.reversed&&r.points.reverse()}))}(e)})),n("    acyclic.undo",(function(){L.undo(e)}))}(n,t)})),t("  updateInputGraph",(function(){!function(e,n){r.forEach(e.nodes(),(function(r){var t=e.node(r),o=n.node(r);t&&(t.x=o.x,t.y=o.y,n.children(r).length&&(t.width=o.width,t.height=o.height))})),r.forEach(e.edges(),(function(t){var o=e.edge(t),i=n.edge(t);o.points=i.points,r.has(i,"x")&&(o.x=i.x,o.y=i.y)})),e.graph().width=n.graph().width,e.graph().height=n.graph().height}(e,n)}))}))},debug:en,util:{time:D,notime:S}};module.exports=nn;
